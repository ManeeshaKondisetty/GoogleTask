/*      Request ID: 4988febd4cd36196a4ebbff975cf97a3_1592492596 (01/26/2021 5:50pm)      */



/*      Resource ID: ec7cee0f2b0c89b3633921d9f7d (payments.js, minified by uglifyjs) (01/26/2021 5:50pm)      */

(function(b){livewhale.payments={};var g=function(e,i){var t=true;var a=e.find(".lw_payments_field_gateway");var l=e.find(".lw_payments_field_gid");var n=e.find(".lw_payments_field_description");var r=e.find(".lw_payments_field_total");var s=e.find(".lw_payments_field_payment_options");var o=e.find(".lw_payments_field_quantity");var _=e.find(".lw_payments_field_first_name");var d=e.find(".lw_payments_field_last_name");var f=e.find(".lw_payments_field_email_address");var h=e.find(".lw_payments_field_phone");var m=e.find(".lw_payments_field_card_number");var p=e.find(".lw_payments_field_expiration_month");var w=e.find(".lw_payments_field_expiration_year");var c=e.find(".lw_payments_charge_method");var u=e.find(".lw_payments_field_zip_code");var v=e.find(".lw_payments_is_required");var y=[];if(!l.length||!l.val()){y.push("The group id field is required.")}if(!n.length||!n.val()){y.push("The description field is required.")}if(!r.length){y.push("The total field is required.")}if(c.length&&!c.val()){y.push("You must choose a payment method.")}if(!s.length||s.val()!=="1"&&s.val()!=="2"&&s.val()!=="3"&&s.val()!=="4"&&s.val()!=="5"){y.push("The payment options field is required.")}if(v.length){var g=false;b.each(v,function(){if(b(this).val()===""){g=true}});if(g){y.push("You must fill out all required fields.")}}if(0===y.length){if(!o.length||!o.val().match(/^[0-9]+$/)){y.push("You must enter a quantity.")}if(!_.length||!d.length||!_.val()||!d.val()){y.push("You must enter a first and last name.")}}if(0===y.length&&(s.val()==="1"||s.val()==="3")&&(!c.length||c.val()==="online")){if(!m.length||!m.val().match(/^[0-9]{15,16}$/)){y.push("You must enter a valid credit card number.")}if(!p.length||!w.length||!p.val().match(/^[0-9]{2}$/)||!w.val().match(/^[0-9]{4}$/)){y.push("You must enter a valid credit card expiration.")}if(u.length&&u.val()&&!u.val().match(/^[0-9\-]+$/)){y.push("Zip code is not in a valid format.")}}if(y.length){e.parent(".lw_payments_registration_form").find(".lw_payments_charge_error").html("<ul><li>"+y.join("</li><li>")+"</li></ul>").show();return false}return true};livewhale.payments.init=function(f){var e={},i=this;b(".lw_payments").each(function(){var r=b(this),e=r.find(".lw_payments_field_gateway"),i=r.find(".lw_payments_field_gid"),t=r.find(".lw_payments_field_description"),a=r.find(".lw_payments_field_payment_options"),l,n,s,o,_;if(e.length&&i.length&&t.length&&a.length&&i.val()&&t.val()&&a.val()){if(window.location.protocol!=="https:"&&parseInt(a.val(),10)!==4){b.ajax({url:"/livewhale/api",method:"GET",dataType:"JSON",async:false,success:function(e){if(e.has_ssl){window.location="https://"+window.location.hostname+window.location.pathname+window.location.hash}return true}})}var d=livewhale.liveurl_dir+"/payments/form";if(livewhale.is_remote){d=livewhale.remote_host+d}b.ajax({url:d,data:r.serialize(),method:"POST",dataType:"JSON",success:function(e){var i,t,a,l;if(e.error||!e.html){return false}if(f&&e.has_ssl&&!window.location.origin.match(/^https/i)){window.location="https://"+window.location.hostname+window.location.pathname+window.location.search}var n=livewhale.liveurl_dir+"/resource/css/livewhale/theme/core/styles/payments.css";if(livewhale.is_remote){n=livewhale.remote_host+n}e.stylesheets.push(n);if(e.stylesheets&&e.stylesheets.length){b.each(e.stylesheets,function(e,i){if(livewhale.remote_host&&i.charAt(0)==="/"){i=livewhale.remote_host+i}livewhale.lib.loadCSS(i)})}if(e.scripts&&e.scripts.length){b.each(e.scripts,function(e,i){if(livewhale.remote_host&&i.charAt(0)==="/"){i=livewhale.remote_host+i}livewhale.lib.loadJS(i)})}t=r.siblings(".lw_widget_type_forms_inline");i=b('<div class="lw_payments_registration_form">'+e.html+"</div>");i.find("form :input").eq(0).before('<input type="text" name="ff-fix1" value="" class="lw_hidden" aria-hidden="true" aria-label="hidden FireFox fix 1"/><input type="password" name="ff-fix2" value="" class="lw_hidden" aria-hidden="true" aria-label="hidden FireFox fix 2"/>');r.replaceWith(i);i.append(t);if(t.length&&t.hasClass("lw_hidden")&&t.siblings().eq(0).prop("tagName")==="H3"){t.find("input[type=submit]").hide();a=r.find(".lw_payments_charge_error");t.removeClass("lw_hidden");a.after(t);l=t.parent();l.find(".lw_payments_charge").addClass("has_additional_form");s="a[href], area[href], input, select, textarea, button, iframe, object, embed, *[tabindex], "+"*[contenteditable]";o="[tabindex=-1], [disabled], :hidden";_=t.find(s).not(o).length;b(s).not(o).each(function(e){var i=b(this);if(i.hasClass("lw_payments_field_events_comments")||i.hasClass("lw_payments_charge_submit")){i.attr("tabindex",e+_)}else if(i.parents(".lw_forms_form").length>0){i.attr("tabindex",e-2)}else{i.attr("tabindex",e)}})}b("body").trigger("paymentFormLoad.lw")}})}});b("body").off("change",".lw_payments_charge_method").on("change",".lw_payments_charge_method",function(e){if(b(this).val()==="online"){b(this).parents("form").find(".lw_payments_for_check").addClass("lw_hidden");b(this).parents("form").find(".lw_payments_for_online").removeClass("lw_hidden")}else if(b(this).val()==="check"){b(this).parents("form").find(".lw_payments_for_online").addClass("lw_hidden");b(this).parents("form").find(".lw_payments_for_check").removeClass("lw_hidden")}else{b(this).parents("form").find(".lw_payments_for_online").addClass("lw_hidden");b(this).parents("form").find(".lw_payments_for_check").addClass("lw_hidden")}});b("body").off("keyup",".lw_payments_field_quantity").on("keyup",".lw_payments_field_quantity",function(e){if(b(this).val().match(/[0-9]+/)){var i=b(this).parents("form").find(".lw_payments_field_total").val(),t=Math.round(i*b(this).val()*Math.pow(10,2))/Math.pow(10,2);if(t.toString().match(/NaN/))t=0;b(this).parents("form").find(".lw_payments_charge_price").html(b(this).parents("form").find(".lw_payments_charge_price").text().replace(/[0-9\.]+/,t.toFixed(2)))}});b("body").off("click",".lw_payments_charge_submit").on("click",".lw_payments_charge_submit",function(e){b(this).prop("disabled",true);var h=b(this),m=h.parents("form"),p=m.closest(".lw_payments_registration_form"),i=m.find(".lw_payments_field_payment_options"),t=m.find(".lw_payments_field_total"),a=m.find(".lw_payments_charge_method"),w=m.parent(".lw_payments_registration_form").find(".lw_payments_charge_error").hide(),l=null,n=true;b("body").trigger("paymentFormBeforeSubmit.lw");if(i.length&&(i.val()==="1"||i.val()==="3")&&(!a.length||a.val()==="online")&&t.length&&t.val()){n=window.confirm("Click OK to proceed with your order. Your credit card will be charged "+b(this).parents("form").find(".lw_payments_charge_price").text()+".")}if(!n){b(this).prop("disabled",false);return}var c=h.text(),r=m.find(".lw_payments_field_gateway"),s=m.find(".lw_payments_field_gid"),o=m.find(".lw_payments_field_description"),_=m.find(".lw_payments_field_type"),d=m.find(".lw_payments_field_id");h.text("Please wait...");if(!g(m)){h.prop("disabled",false);h.text(c);return false}var f=r.val()?r.val()+"Validate":"";var u=(new Date).getTime()/1e3;var v=function(){var e=false,n,i,t,r,s,o,_,a,l;if(m.hasClass("has_additional_form")){n=m.parent(".lw_payments_registration_form").find(".lw_widget_type_forms_inline form");if(n.length){e=true}}if(e){i=n.find('input[name="lw_form_id"]').val();r="?livewhale=ajax&function=handleFormsSubmission&id="+i+"&from_rsvp=1";s=n.serialize();o=livewhale.liveurl_dir+"/payments/charge";_=m.serialize();if(livewhale.remote_host){r=livewhale.remote_host+"/livewhale/frontend.php"+r;o=livewhale.remote_host+o}else{r=livewhale.page+r}a=b.post(r,s+"&is_validation=1",null,"json");l=b.post(o,_+"&is_validation=1",null,"json");b.when(a,l).done(function(e,i){var t,a,l="";if(e[0].error||i[0].error){if(e[0].error)l+=e[0].error;if(i[0].error)l+=i[0].error;w.html("<ul><li>"+l+"</li></ul>").show();h.prop("disabled",false);h.text(c)}else{b.post(r,s,function(e){if(e.error)return false;b.post(o,_+(e.submission_id?"&associate_form_submission="+e.submission_id:""),function(e){n.remove();if(!e.error&&e.html){m.parent().find(".lw_payments_charge_header").remove();b(".lw_events_registration_instructions").hide();m.replaceWith(e.html)}else if(e.error){w.html("<ul><li>"+e.error+"</li></ul>").show();h.prop("disabled",false);h.text(c)}b("html,body").scrollTop(p.offset().top)},"json")},"json")}})}else{t=livewhale.liveurl_dir+"/payments/charge";if(livewhale.remote_host){t=livewhale.remote_host+t}var d=[];var f={lw_payments_field_card_number:true,lw_payments_field_cvc_number:true,lw_payments_field_expiration_month:true,lw_payments_field_expiration_year:true};b.each(m.serializeArray(),function(e,i){if(!f[i.name]){d.push(i)}});b.post(t,d,function(e){if(!e.error&&e.html){m.parent().find(".lw_payments_charge_header").remove();b(".lw_events_registration_instructions").hide();m.replaceWith(e.html)}else if(e.error){w.html("<ul><li>"+e.error+"</li></ul>").show();h.prop("disabled",false);h.text(c)}b("html,body").scrollTop(p.offset().top)},"json")}};var y=function(){h.prop("disabled",false);h.text(c)};if(i.length&&(i.val()==="1"||i.val()==="3")&&(!a.length||a.val()==="online")&&f&&typeof window[f]==="function"){window[f](m,v,y)}else{v()}})}})(livewhale.jQuery,window.jQuery);