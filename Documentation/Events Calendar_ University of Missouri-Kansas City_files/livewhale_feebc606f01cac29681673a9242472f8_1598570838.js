/*      Request ID: feebc606f01cac29681673a9242472f8_1598570838 (01/24/2021 7:54pm)      */



/*      Resource ID: ca10c4977a4f2999582c6561bd9 (calendar.js, minified by uglifyjs) (01/24/2021 7:54pm)      */

if(!Date.prototype.toISOString){(function(){function e(e){if(e<10){return"0"+e}return e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}})()}(function(L,O){var E=window.livewhale||{},Y=L("body"),H=L("#lw_cal"),l=E.logged_in&&E.has_ssl?"https:":window.location.protocol,R=l+"//"+window.location.host+livewhale.page,e=E.liveurl_dir||"/live",W;if(!E.lib)E.lib={};E.lwCalendar={};O.templateSettings={evaluate:/\{\[(.+?)\]\}/g,interpolate:/\{\{(.+?)\}\}/g};var P={getWidgetSyntaxFromArgObject:function(e){var i='<widget type="events_calendar">';e=e||{};L.each(e,function(a,e){if(L.isArray(e)){L.each(e,function(e,t){i+='<arg id="'+a+'">'+t+"</arg>"})}else{i+='<arg id="'+a+'">'+e+"</arg>"}});i+="</widget>";return encodeURIComponent(i)}};function n(I){var e=E.lwc_use_pushstate||false;var S=window.history&&window.history.pushState&&e?true:false;var F=!S?"#!":"";var _=window.location.pathname;if(S&&E.page){_=E.page?E.page.substring(0,E.page.lastIndexOf("/")+1):"/"}Y.append('<a href="'+_+F+"view/seo"+'" style="display:none;">All Events</a>');var M=function(e){this._dt=e};L.extend(M.prototype,{format:function(e){return e.replace(this._formatChr,L.proxy(this._formatChrCb,this))},_txt_words:["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"],_formatChr:/\\?(.?)/gi,_formatChrCb:function(e,t){return this[e]?this[e]():t},_pad:function(e,t){e=String(e);while(e.length<t){e="0"+e}return e},d:function(){return this._pad(this.j(),2)},D:function(){return this.l().slice(0,3)},j:function(){return this._dt.getDate()},l:function(){return this._txt_words[this.w()]+"day"},N:function(){return this.w()||7},S:function(){var e=this.j(),t=e%10;if(t<=3&&parseInt(e%100/10,10)===1){t=0}return["st","nd","rd"][t-1]||"th"},w:function(){return this._dt.getDay()},z:function(){var e=new Date(this.Y(),this.n()-1,this.j()),t=new Date(this.Y(),0,1);return Math.round((e-t)/864e5)},W:function(){var e=new Date(this.Y(),this.n()-1,this.j()-this.N()+3),t=new Date(e.getFullYear(),0,4);return this._pad(1+Math.round((e-t)/864e5/7),2)},F:function(){return this._txt_words[6+this.n()]},m:function(){return this._pad(this.n(),2)},M:function(){return this.F().slice(0,3)},n:function(){return this._dt.getMonth()+1},t:function(){return new Date(this.Y(),this.n(),0).getDate()},L:function(){var e=this.Y();return e%4===0&e%100!==0|e%400===0},o:function(){var e=this.n(),t=this.W(),a=this.Y();return a+(e===12&&t<9?1:e===1&&t>9?-1:0)},Y:function(){return this._dt.getFullYear()},y:function(){return this.Y().toString().slice(-2)},a:function(){if(I.ampm_with_dots){return this._dt.getHours()>11?" p.m.":" a.m."}else{return this._dt.getHours()>11?"pm":"am"}},A:function(){return this.a().toUpperCase()},q:function(){return this._dt.getHours()>11?" p.m.":" a.m."},B:function(){return""},g:function(){return this.G()%12||12},G:function(){return this._dt.getHours()},h:function(){return this._pad(this.g(),2)},H:function(){return this._pad(this.G(),2)},i:function(){return this._pad(this._dt.getMinutes(),2)},s:function(){return this._pad(this._dt.getSeconds(),2)},u:function(){return this._pad(this._dt.getMilliseconds()*1e3,6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)"},I:function(){var e=new Date(this.Y(),0),t=Date.UTC(this.Y(),0),a=new Date(this.Y(),6),i=Date.UTC(this.Y(),6);return e-t!==a-i?1:0},O:function(){var e=this._dt.getTimezoneOffset(),t=Math.abs(e);return(e>0?"-":"+")+this._pad(Math.floor(t/60)*100+t%60,4)},P:function(){var e=this.O();return e.substr(0,3)+":"+e.substr(3,2)},Z:function(){return-this._dt.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(this._formatChr,this._formatChrCb)},r:function(){return"D, d M Y H:i:s O".replace(this._formatChr,this._formatChrCb)},U:function(){return this._dt._date/1e3|0}});var A=E.lib.LWCDate=function(e,t,a){if(e){t=L.isNumeric(t)?parseInt(t,10):0;this._date=new Date(parseInt(e,10)*1e3+parseInt(t,10)*1e3)}else if(a){this._date=new Date(a.valueOf()-a.getTimezoneOffset()*60*1e3)}this._formatter=new M(this)};A.time_format={us:E.time_format_us,euro:E.time_format_euro};A.date_format={us:E.date_format_us,euro:E.date_format_euro};A.user_format_zone="us";A.setUserFormatZone=function(e){A.user_format_zone=e};A.getUserFormatZone=function(){return A.user_format_zone};A.getUserDateFormat=function(){return A.date_format[A.user_format_zone]?A.date_format[A.user_format_zone]:"m/d/Y"};A.getUserTimeFormat=function(){return A.time_format[A.user_format_zone]?A.time_format[A.user_format_zone]:"g:ia"};L.extend(A.prototype,{month_names_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],getFormattedDate:function(e){return this._formatter.format(e)},getDateObject:function(){return this._date},getTimeString:function(e){var t=e&&A.time_format[e]?A.time_format[e]:A.getUserTimeFormat();return this._formatter.format(t)},getShortDateString:function(e){var t=e&&A.date_format[e]?A.date_format[e]:A.getUserDateFormat();return this._formatter.format(t)},getDateTimeString:function(){return this.month_names_short[this._date.getUTCMonth()]+" "+this._date.getUTCDate()+", "+this.getTimeString()},isDayStart:function(){return 0===this.getHours()&&0===this.getMinutes()},getHours:function(){return this._date.getUTCHours()},getMinutes:function(){return this._date.getUTCMinutes()},getSeconds:function(){return this._date.getUTCSeconds()},getMilliseconds:function(){return this._date.getUTCMilliseconds()},getFullYear:function(){return this._date.getUTCFullYear()},getMonth:function(){return this._date.getUTCMonth()},getDate:function(){return this._date.getUTCDate()},getDay:function(){return this._date.getUTCDay()},getTime:function(){return this._date.getTime()},setTimeToZero:function(){this._date.setUTCHours(0);this._date.setUTCMinutes(0);this._date.setUTCSeconds(0)},setHours:function(e,t,a,i){this._date.setHours(e,t,a,i)},setDate:function(e){this._date.setUTCDate(e)}});var z={makePhoneLinks:function(e){if(!e||typeof e!=="string"){return e}var t=/\b([(]{0,1}[0-9]{3}[)]{0,1}[-\s\.]{0,1}[0-9]{3}[-\s\.]{0,1}[0-9]{4})\b(?!([^<]*>|<\/a>))/g;return e.replace(t,function(e,t){return'<a href="tel:'+t.replace(/[^\d]/g,"")+'">'+t+"</a>"})},makeMailtoLinks:function(e){if(!e||typeof e!=="string"){return e}return e.replace(/\b([A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,})\b/gi,function(e,t){return'<a href="mailto:'+t+'">'+t+"</a>"})},setImageDimensions:function(e,t,a){if(!t&&!a)return;var i=t?"/width/"+t:"";var n=a?"/height/"+a:"";e=e.replace(/\/width\/[\d]+/,i);e=e.replace(/\/height\/[\d]+/,n);e=e.replace(/\/crop\/[\d]+/,"");e=e.replace(/\/src_region\/[\d,]+/,"");return e},formatDate:function(e,t){return t&&e?new A(null,null,e).getFormattedDate(t):""},formatTimestamp:function(e,t,a){var i=""+e;var n=""+t;return a&&i.match(/^[\d]+$/)&&n.match(/^\-?[\d]*$/)?new A(e,t).getFormattedDate(a):""}};z.formattedDate=z.formatTimestamp;var t={initUrlChangeHandler:function(){var t=this;L(window).hashchange(function(){var e=window.location.hash;e=e.replace(/^#!?/,"");if(e&&(e===t.getHash()||e.length>2&&e.indexOf("view/")===-1&&e.indexOf("date/")===-1)){return}t.parseHash();t.load(L.noop,true)});if(!this.hashHasBang()){this.addBangToHash()}this.parseHash();this.load(function(){Y.trigger("calInit.lwcal",[t])},true)},hashHasBang:function(){return 1===window.location.hash.indexOf("!")?true:false},addBangToHash:function(){var e=window.location.hash;if(e.length>1){window.location.hash="#!"+e.substr(1)}},updateUrl:function(){var e=this.getHash();if(e){window.location.hash="!"+e}},buildUrlArgString:function(){var e=[];var t;for(t in this.vars){var a=[];for(var i in this.vars[t]){a.push(encodeURIComponent(this.vars[t][i]))}e.push(t+"/"+a.join("|"))}e=e.sort(function(e,t){if(e.match(/^view/)){return-1}else if(t.match(/^view/)){return 1}else{if(e<t){return-1}if(e>t){return 1}return 0}});return e.length?e.join("/"):""}};var a={initUrlChangeHandler:function(){var t=this;window.addEventListener("popstate",function(e){t.parseUrl();t.load(L.noop,a)});if(window.location.hash&&!this.getUrlArgString()){this.convertDeprecatedHashBasedUrl()}else{this.parseUrl();var a=true;if(S){var e=this.getUrlArgString();if(e.indexOf("view/")===0){a=false}if(I.event_view_name!=="event"&&e.indexOf("event/")===0){a=false}}this.load(function(){Y.trigger("calInit.lwcal",[t])},a)}},convertDeprecatedHashBasedUrl:function(){this.parseHash();window.location.hash="";this.updateUrl()},updateUrl:function(){var e=this.buildUrlArgString();var t=E.page.substring(0,E.page.lastIndexOf("/")+1);if(e!==this.getUrlArgString()){window.history.pushState(null,null,t+e)}},buildUrlArgString:function(){var e=this.getView();var t=e;var n=this;if(e===I.event_view_name){var a=this.getVar("event_id");if(a.length){t+="/"+a[0]}}else{var s=[];O.each(this.vars,function(e,t){if(t==="view"){return true}var a=[];for(var i in n.vars[t]){a.push(encodeURIComponent(n.vars[t][i]))}s.push(t+"/"+a.join("|"))});s=s.sort(function(e,t){if(e<t){return-1}if(e>t){return 1}return 0});if(s.length){t+="/"+s.join("/")}}return t}};var d=E.lwCalendar.controller=O.extend({vars:{},qstring:{},data:null,is_today:true,init:function(){var a=this;Y.trigger("beforeCalInit.lwcal");this.history=[];this.default_view=I.default_view||"day";this.is_first_load=true;Y.on("calLoad.lwcal",function(e){a.is_first_load=false;return true});Y.on("lw.calendarViewClick",function(e,t){a.setVarsInRelativeUrl(t);if("all"===a.getView()){a.clearVar("date")}a.clearVar("more");a.load();return true});this.initUrlChangeHandler()},getTimezone:function(){var e,t,a,i;if(!this._user_tz&&E.lib.localStore.has()&&localStorage.lwLocalTimezone&&-1!==localStorage.lwLocalTimezone.lastIndexOf("}")){a=JSON.parse(localStorage.lwLocalTimezone);i=(new Date).getTime();if(L.isPlainObject(a)&&a.timestamp&&i-a.timestamp<864e5*5){this._user_tz=a.value}}if(!this._user_tz){e=(new Date).toString();t=e.match(/\(([^\)]+)\)$/)||e.match(/([A-Z]+) [\d]{4}$/);this._user_tz="EST";if(L.isArray(t)&&t.length>1){var n=t[1].match(/[A-Z]/g);if(n){this._user_tz=n.join("")}}var s=e.split(" ")[5];if(L.browser.mozilla&&navigator.appVersion.indexOf("Win")!==-1){if(s==="GMT-0700"){this._user_tz="PDT"}if(s==="GMT-0400"){this._user_tz="EDT"}}}return this._user_tz},setTimezone:function(e){var t;this._user_tz=e;if(E.lib.localStore.has()){t={value:e,timestamp:(new Date).getTime()};localStorage.lwLocalTimezone=JSON.stringify(t)}},getVar:function(e){return L.isArray(this.vars[e])?this.vars[e]:[]},getView:function(){return this.getVar("view").length?this.getVar("view")[0]:this.default_view},setDate:function(e,t,a){e=e.toString();t=t.toString();a=a.toString();if(t.length===1)t="0"+t;if(a.length===1)a="0"+a;this.setVar("date",e+t+a)},sanitizeVar:function(e){return L.trim(L("<p>"+e+"</p>").text().replace(/>/g,"&gt;").replace(/</g,"&lt;"))},setVar:function(e,t){if(!e||!t)return;if(!L.isArray(t)){t=[t]}this.vars[e]=O.map(t,this.sanitizeVar)},appendVar:function(e,t){if(!L.isArray(this.vars[e]))this.vars[e]=[];this.vars[e].push(this.sanitizeVar(t))},removeVar:function(e,t){if(L.isArray(this.vars[e])){var a=L.inArray(L.trim(t),this.vars[e]);if(-1!==a){this.vars[e].splice(a,1);if(!this.vars[e].length){this.clearVar(e)}}}},clearVar:function(e){delete this.vars[e];if(!this.vars.view){this.setVar("view",this.default_view)}},clearVars:function(a){var i=this;var n={language:true};O.each(this.vars,function(e,t){if(a||!n[t]){delete i.vars[t]}})},getValue:function(e){return L.isArray(this.vars[e])?this.vars[e]:false},load:function(t,e,a){var i=this,n=this.getView();Y.trigger("calBeforeChange.lwcal",[i,n]);if(!a){this.history.push(O.clone(this.vars))}if(!e){this.updateUrl()}function s(e){if(!e)e={};Y.trigger("calChange.lwcal",[i,n,e]);if(L.isFunction(t))t.apply(i);i.registerGoogleAnalyticsPageView()}if(n==="feed_builder"){s()}else{var r={url:this.getAjaxUrl(),dataType:"json",success:function(e){if(i.getTimezone().length<5&&e.user_tz){i.setTimezone(e.user_tz)}if(e.user_format&&e.user_format!==A.getUserFormatZone()){A.setUserFormatZone(e.user_format)}s(e)}};if(I.with_credentials){L.extend(r,{xhrFields:{withCredentials:true}})}L.ajax(r)}},registerGoogleAnalyticsPageView:function(){var e="send",t,a;if(!(window._gaq&&window._gaq.push)&&!(O.isObject(window.ga)&&window.ga.getByName)&&!(typeof E.custom_tracking==="function"))return;t=I.event_view_name===this.getView()?E.liveurl_dir+"/events/"+this.getVar("event_id")[0]:window.location.pathname+window.location.hash;if(typeof E.custom_tracking==="function"){E.custom_tracking(t);return}if(window._gaq){window._gaq.push(["_trackPageview",t])}if(window.ga&&window.ga.getAll){a=window.ga.getAll();if(a.length&&a[0].get("name")){e=a[0].get("name")+".send"}window.ga(e,"pageview",t)}},loadEventDetailHref:function(e){var t=e.substr(e.lastIndexOf("/")+1).match(/^\d+/);if(!t)return false;this.clearVars();this.setVar("event_id",t[0]);this.setVar("view","event");this.load();return true},getHash:function(){return this.buildUrlArgString()},getUrlArgString:function(){var e=window.location.pathname,t=E.page.substring(0,E.page.lastIndexOf("/")+1);return e!==E.page&&0===e.indexOf(t)?e.substr(t.length):""},parseUrl:function(){var a=this;var e=this.getUrlArgString();a.clearVars();if(!e){return}var t=e.split("/");var i=t[0].trim();var n=false;if(O.includes(I.valid_views,i)){a.setVar("view",i===I.event_view_name?"event":i);t.shift();if(i===I.event_view_name){n=true;if(t.length&&t[0].match(/^\d+.*/)){a.setVar("event_id",t[0])}}}if(!n&&t.length&&t.length%2===0){O.each(this.parseUrlArgString(t.join("/")),function(e,t){a.setVar(t,e)})}},parseHash:function(){var a=this,e;this.vars={};e=window.location.href.split("#")[1]||"";e=e.replace(/^!/,"");if(!e)return;O.each(this.parseUrlArgString(e),function(e,t){a.setVar(t,e)});return},parseUrlArgString:function(e){var t=typeof e==="string"?e.split("/"):[],a={},i,n;for(var s=0;s<t.length;s+=2){i=decodeURIComponent(t[s+1]).replace(/</g,"&lt;").replace(/>/g,"&gt;");a[t[s]]=i.split("|")}return a},setVarsInRelativeUrl:function(e,t){if(!e)return;if(-1!==e.indexOf("#")){e=e.substring(e.indexOf("#")+1);e=e.replace(/^!/,"")}var a=d.parseUrlArgString(e);if(t){d.clearVars()}O.each(a,function(e,t){d.setVar(t,e)})},setVarsWithQueryString:function(e){var t=this.parseQueryString(e);for(var a in t){this.setVar(a,decodeURIComponent(t[a]).split("|"))}},parseQueryString:function(e){var t=e.substr(e.lastIndexOf("?")+1),a=t.split("&"),i={};for(var n=0;n<a.length;n++){var s=a[n].split("=");i[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return i},convertQueryStringAndRefresh:function(){if(E.is_remote||!window.location.search)return;this.setVarsWithQueryString(window.location.search);window.location=R+"#!"+this.getHash()},getAjaxQueryString:function(){var e=[],t="";for(var a in this.vars){e.push(a+"="+encodeURIComponent(this.vars[a].join("|")))}if(e.length){t="&"+e.join("&")}if(!O.includes(this.vars,"view")){t+="&view="+this.getView()}t+="&user_tz="+encodeURIComponent(this.getTimezone());t+="&syntax="+this.getWidgetSyntax();return t},getValidYmd:function(e){var t=true,a,i;if(!e.match(/^\d{8}$/)){return n.getYmdFromDate(new Date)}else{i=new Date(parseInt(e.substring(0,4),10),parseInt(e.substring(4,6),10),0).getDate();a=parseInt(e.substring(6,8),10);return a>=1&&a<=i?e:e.substring(0,6)+"01"}},getViewTemplateVariables:function(){return w.getTemplateVariables(this.getView())},getAjaxUrl:function(e){var t=e?O.extend(this.vars,e):this.vars;var i=this;var n;if(E.remote_host){n=E.remote_host+E.liveurl_dir}else{n=E.liveurl_dir}n+="/calendar/view/"+this.getView();O.each(t,function(e,t){if("view"===t||"language"===t){return true}var a;if("date"===t){a=i.getValidYmd(e[0])}else if("event_id"===t){a=e[0].replace(/^(\d+).*/,"$1")}else{a=encodeURIComponent(e.join("|"))}n+="/"+t+"/"+a});n+="?user_tz="+encodeURIComponent(this.getTimezone());if(this.getVar("language").length){n+="&language="+encodeURIComponent(this.getVar("language")[0])}var a=this.getViewTemplateVariables();if(a.length){var s=[];if(-1!==L.inArray("single_events",a)){s.push("single_events")}if(-1!==L.inArray("repeating_events",a)){s.push("repeating_events")}if(s.length){n+="&show="+encodeURIComponent(s.join(","))}}n+="&syntax="+this.getWidgetSyntax();return n},back:function(){var a=this;if(this.history.length<=1)return;this.clearVars(true);this.history.pop();O.each(this.history.pop(),function(e,t){O.each(e,function(e){a.appendVar(t,e)})});this.load()},getWidgetSyntax:function(){var e,t,a;if(!this.syntax){e=L("#lw_cal .lw_widget_syntax,#lw_cal_body_wrapper .lw_widget_syntax");if(E.is_remote||!e.length){this.syntax=P.getWidgetSyntaxFromArgObject(I.widget_args||{})}else{this.syntax=e.attr("title")}}return this.syntax}},S?a:t);var i={month_names:["Jan<span>uary</span>","Feb<span>ruary</span>","Mar<span>ch</span>","Apr<span>il</span>","May","Jun<span>e</span>","Jul<span>y</span>","Aug<span>ust</span>","Sept<span>ember</span>","Oct<span>ober</span>","Nov<span>ember</span>","Dec<span>ember</span>"],month_names_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_names:["Sun<span>day</span>","Mon<span>day</span>","Tue<span>sday</span>","Wed<span>nesday</span>","Thu<span>rsday</span>","Fri<span>day</span>","Sat<span>urday</span>"]};var u={init:function(){var i=this,e=d.getTimezone();var t=O.template(L("#lw_cal_timezone_menu_template",W).html());L("#lw_cal_body").append(t({timezones:E.calendar.timezones}));var a=this.$el=L("#lw_cal_tz",H);var n=this.$content=L(".lw_cal_tz_selector_content",a);var s=this.$sel=n.find(".lw_cal_tz_select");this.$wrapper=null;if(e.match(/[A-Z]{3,5}/)){s.find('option[data-tz-abbrv="'+e+'"]').eq(0).prop("selected",true)}else{s.val(e)}a.find(".lw_submit").on("click",function(e){var t=L("option:selected",s),a=t.val();if(a&&d.getTimezone()!==a){d.setTimezone(a);d.load()}i.close()});a.find(".lw_cancel").on("click",function(e){i.close()});Y.trigger("calTzDialogInit.lwcal")},open:function(e){var t=this,a;if(!this.$el){this.init()}e.hoverbox({position:"top",autoOpen:true,html:this.$el.show(),beforeOpen:function(){Y.trigger("click")},close:function(){t.$el.hide().appendTo("body");L(this).hoverbox("destroy")}});this.$wrapper=e},close:function(){this.$wrapper.hoverbox("close")}};var f=function(s){var a=this;var e=Math.floor(Date.now()/1e3);var t=new M(new A(e,E.calendar.default_timezone_offset));var i=O.template(L("#lw_cal_view_selector_template",W).html());L("#lw_cal_view_selector").replaceWith(i({date:t.format("Ymd"),display_date:t.format("F j, Y")}));this.$el=L("#lw_cal_view_selector");if(!this.$el.length)return;this.$el.on("click","a",function(e){var t=L(this);if(t.closest("li").hasClass("add_new")){return true}e.preventDefault();Y.trigger("lw.calendarViewClick",[L(this).attr("href")]);return true}).removeClass("lw_hidden").show();if(I.exclude_view){if(typeof I.exclude_view==="string")I.exclude_view=[I.exclude_view];if(L.isArray(I.exclude_view)){O.each(I.exclude_view,function(e,t){if(e==="day"){a.$el.find("li.day").remove();a.$el.find("li.today").remove()}else{a.$el.find("li."+e).remove()}})}}this.$add_event_link=this.$el.find("#lw_cal_add_event a");this.add_event_url=this.$add_event_link.attr("href");Y.on("calLoad.lwcal",O.bind(function(e,t,a){var i=t.getView();this.$el.find(".active").removeClass("active");var n=!I.enable_home_view&&(!i||"day"===i&&s.getView().is_today)?"today":i;this.$el.find("."+n).addClass("active");this.$add_event_link.attr("href",this.add_event_url);this.$el.find("#lw_cal_events_badge").remove();if(a.event_count){this.$el.find("li.all a").append('<div id="lw_cal_events_badge" class=>'+a.event_count+"</div>")}},this))};var g=function(){var e=O.template(L("#lw_cal_header_template",W).html());L("#lw_cal_header").replaceWith(e());var t=this.$header=L("#lw_cal_header");this.$title=L("#lw_cal_this_day",t);this.$scroll_links=L("#lw_cal_scroll_links",t);this.$date_sel=L("#lw_cal_date_selector");this.scroll_template=O.template(L("#lw_cal_scroll_link_template",W).html());t.on("click",".lw_cal_date_scroll a, #lw_cal_date_selector a",function(e){e.preventDefault();d.setVarsInRelativeUrl(L(this).attr("href"));d.load();return true});Y.on("change",".lw_cal_date_picker",function(e){e.preventDefault();var t=L(this).val();if(t){d.setVar("date",t);d.load()}return true});Y.on("click","#lw_cal_showing a:not(.lw_cal_clear_filters)",function(e){e.preventDefault();var t=L(this),a=t.attr("class").replace("lw_cal_showing_",""),i=decodeURIComponent(t.attr("href"));if(i.indexOf("/")){i=i.substr(i.lastIndexOf("/")+1)}if(a){d.removeVar(a,i);d.load()}return true});Y.on("click",".lw_cal_clear_filters",function(e){e.preventDefault();d.clearVar("categories");d.clearVar("audience");d.clearVar("campus");d.clearVar("tags");d.clearVar("groups");d.clearVar("locations");d.clearVar("search");d.clearVar("date");d.clearVar("end_date");d.load();return true});Y.on("mouseover","#lw_cal_showing a",function(e){L(this).addClass("X");return true});Y.on("mouseover","#lw_cal_showing a",function(e){L(this).removeClass("X");return true});Y.on("click",".lw_cal_back",function(e){e.preventDefault();if(d.history.length>1){d.back()}else{d.clearVars();d.load()}return false})};g.prototype={setTitle:function(e){this.$title.html(e)},clearScrollLinks:function(){this.$scroll_links.html("")},insertScrollLinks:function(e,t){this.$scroll_links.html(this.scroll_template({prev_date:e,next_date:t}))},show:function(){this.$header.css("visibility","visible")},hide:function(){this.$header.css("visibility","hidden")},showBackLink:function(){this.$scroll_links.html('<a href="" class="lw_cal_back"><span class="lw-icon-2x lw-icon-times-circle"></span><span class="lw_sr_only">Close Event</span></a>')},clearDateSelector:function(){this.$date_sel.html("")},insertDateSelector:function(e){this.$date_sel.html(e)},getTitle:function(){return this.$header.find("h5").text()}};var n=O.extend({},i,{$el:H,$body:L("#lw_cal_body",this.$el),$events:L("#lw_cal_events",this.$el),is_mobile:L(window).width()<=480?true:false,$subscription_menu:null,event_template:O.template(L("#lw_cal_event_template",W).html()),date_sel_template:O.template(L("#lw_cal_date_selector_template",W).html()),show:function(){this.$events.removeClass("lw_cal_loading");this._cal.getHeader().show()},hide:function(){this.$events.css("visibility","hidden");this._cal.getHeader().hide()},getDateFromTimestamp:function(e,t){return new Date(parseInt(e,10)*1e3+parseInt(t,10)*1e3)},hasDifferentLocalTimezone:function(e){var t=e.tz_abbrv.replace(/^(\w)(\w+)(\w)$/,function(e,t,a,i,n,s){return t+a.replace(/S/g,"D")+i});var a=e.tz_abbrv.replace(/^(\w)(\w+)(\w)$/,function(e,t,a,i,n,s){return t+a.replace(/D/g,"S")+i});return e.user_abbrv!==e.tz_abbrv&&e.user_abbrv!==t&&e.user_abbrv!==a?true:false},getEventTimeRange:function(e,t,a){var i=this.hasDifferentLocalTimezone(e),n=I.hide_local_timezone||a||!i?false:true,s=false,r=false,l="",o,c,h;o=new A(e.ts_start,e.tz_offset);c=e.ts_end?new A(e.ts_end,e.tz2_offset):null;if(o.isDayStart()){s=true}if(c&&(o.getMonth()!==c.getMonth()||o.getDate()!==c.getDate())){r=true}if(e.is_all_day){l="All Day";if(r&&c){l+=' <span class="lw_until">(until ';if(!c.isDayStart()){l+=c.getTimeString(e.tz_format)}if(E.timezone_format==="euro"){l+=" "+c.getDate()+" "+this.month_names[c.getMonth()]+")</span>"}else{l+=" "+this.month_names[c.getMonth()]+" "+c.getDate()+")</span>"}}if(e.time_postfix)l+=' <span class="postfix">'+e.time_postfix+"</span>";return l}l=this.getTimes(o,c,s,r,e.tz_format);if((!t&&!I.hide_local_timezone||i)&&!I.disable_timezone){l+=' <span class="lw_cal_tz_abbrv'+(!n?" tz_editable":"")+'">'+e.tz_abbrv+"</span>"}if(n&&!I.disable_timezone){h=this.getLocalTimeRange({ts_start:e.ts_start,ts_end:e.ts_end,tz_offset:e.user_offset,tz2_offset:e.user_offset,tz_abbrv:e.user_abbrv},e,s,r);l+=' <span class="lw_user_time">('+h+")</span>"}if(e.time_postfix)l+=' <span class="postfix">'+e.time_postfix+"</span>";return l},getDateRangeFromTimestamps:function(e,t,a,i){var n=new A(e,a),s,r;if(t){s=new A(t,i)}return this.getDateRange(n,s)},getDateRange:function(e,t){var a;if(t&&e.getMonth()!==t.getMonth()){if(E.timezone_format==="euro"){a='<span class="lw_date_range">'+'<span class="lw_date">'+e.getDate()+"</span> "+this.month_names_short[e.getMonth()]+'<span class="lw_date_range_separator"> - </span>'+'<span class="lw_date">'+t.getDate()+"</span> "+this.month_names_short[t.getMonth()]+"</span>"}else{a='<span class="lw_date_range">'+this.month_names_short[e.getMonth()]+' <span class="lw_date">'+e.getDate()+"</span>"+'<span class="lw_date_range_separator"> - </span>'+this.month_names_short[t.getMonth()]+' <span class="lw_date">'+t.getDate()+"</span>"+"</span>"}}else if(t&&e.getDate()!==t.getDate()){if(E.timezone_format==="euro"){a='<span class="lw_date_range lw_same_month">'+'<span class="lw_date">'+e.getDate()+"</span> "+this.month_names_short[e.getMonth()]+'<span class="lw_date_range_separator"> - </span>'+'<span class="lw_date">'+t.getDate()+"</span> "+this.month_names_short[t.getMonth()]+"</span>"}else{a='<span class="lw_date_range lw_same_month">'+this.month_names[e.getMonth()]+' <span class="lw_date">'+e.getDate()+" - "+t.getDate()+"</span>"+"</span>"}}else{a=this.month_names[e.getMonth()]+' <span class="lw_date">'+e.getDate()+"</span>"}a+='<span class="lw_year">, '+(t?t.getFullYear():e.getFullYear())+"</span>";return a},getLocalTimeRange:function(e,t,a,i,n){var s=new A(e.ts_start,e.tz_offset),r=new A(t.ts_start,t.tz_offset),l=e.ts_end?new A(e.ts_end,e.tz2_offset):null,o=864e5,c,h;c=this.getTimes(s,l,a,i,null);r.setTimeToZero();s.setTimeToZero();h=(s.getTime()-r.getTime())/o;if(0!==h){c+=" "+(h<0?"-":"+")+Math.abs(h)+" Day";if(Math.abs(h)>1)c+="s"}if(!n&&!I.hide_local_timezone){c+=' <span class="lw_cal_tz_abbrv tz_editable">'+e.tz_abbrv+"</span>"}return c},getTimes:function(e,t,a,i,n){var s;if(a&&t){s='until <span class="lw_end_time">'+t.getTimeString(n)+"</span>";if(i){s+=' <span class="lw_end_date">'+this.month_names[t.getMonth()]+" "+t.getDate()+"</span>"}}else{s='<span class="lw_start_time">'+e.getTimeString(n)+"</span>";if(t){if(0!==t.getHours()||0!==t.getMinutes()){s+=' - <span class="lw_end_time">'+t.getTimeString(n)+"</span> "}if(i){s+=' <span class="lw_start_date">';s+=E.timezone_format==="euro"?e.getDate()+" "+this.month_names[e.getMonth()]:this.month_names[e.getMonth()]+" "+e.getDate();s+="</span>";s+=" - ";s+='<span class="lw_end_date">';s+=E.timezone_format==="euro"?t.getDate()+" "+this.month_names[t.getMonth()]:this.month_names[t.getMonth()]+" "+t.getDate();s+="</span>"}}}return s},getDateFromYmd:function(e){var t=parseInt(e.substr(0,4),10),a=parseInt(e.substr(4,2),10),i=parseInt(e.substr(6,2),10);return new Date(t,a-1,i)},getYmdFromDate:function(e){var t=e.getFullYear(),a=e.getMonth()+1,i=e.getDate();t=t.toString();a=a.toString();i=i.toString();if(1===a.length)a="0"+a;if(1===i.length)i="0"+i;return t+a+i},getMonthAndDayFromTimestamp:function(e,t){var a=this.getDateFromTimestamp(e,t);return this.month_names[a.getMonth()]+" "+a.getDate()},getMdYFromDate:function(e){return this.month_names[e.getMonth()]+" "+e.getDate()+", "+e.getFullYear()},getFormattedListDate:function(e){return this.day_names[e.getDay()]+", "+this.month_names[e.getMonth()]+" "+e.getDate()},setViewClass:function(e){this.$el.removeClass(function(e,t){return(t.match(/lw_cal_\w+_view/g)||[]).join(" ")});this.$el.addClass("lw_cal_"+e+"_view");Y.removeClass(function(e,t){return(t.match(/lw_cal_view_\w+/g)||[]).join(" ")});Y.addClass("lw_cal_view_"+e);if(d.getVar("search").length){Y.addClass("lw_cal_view_search")}if(e===I.event_view_name){Y.addClass("lw_cal_event_detail")}else{Y.removeClass("lw_cal_event_detail")}},getEventTitleLink:function(e){var t="";var a=[];var i;if(e.external_url){i=e.external_url;a.push("external_url")}else if(e.href){i=e.href}if(i){if(e.status===2){a.push("hidden_event")}t='<a href="'+i+'"';if(a.length){t+=' class="'+a.join(" ")+'"'}t+=">"+e.title+"</a>"}else{t=e.title}return t},slugify:function(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},getEventUrl:function(e,t){var a;if(S){a=I.event_view_name+"/"+String(e)+"-"+this.slugify(t)}else{a=F+"view/event/event_id/"+e}if(_){a=_+a}return a},addHostToSrcSetFilter:function(e,a){var i=e.match(/\ssrcset="([^"]*)"/);if(i){i[1]=i[1].split(", ");L.each(i[1],function(e,t){if(t.charAt(0)==="/"&&(t.length===1||t.charAt(1)!=="/")){i[1][e]=a+t}});i[1]=i[1].join(", ");return e.replace(/\ssrcset="([^"]*)"/,' srcset="'+i[1]+'"')}return e},addHostToLinks:function(e,i){return e.replace(/\shref="([^"]*)"/,function(e,t){var a=e;if(0!==t.indexOf("http")&&0!==t.indexOf("//")&&-1===t.indexOf("mailto:")){if(0!==t.indexOf("/")){t="/"+t}a=' href="'+i+t+'"'}return a})},formatEventObject:function(a){var e={location:"",summary:"",href:"",title:""};O.each(e,function(e,t){if(!O.has(a,t)){a[t]=e}});if(!a.external_url&&a.href&&_){a.href=_+a.href}if(O.isArray(a.category_classes)&&a.category_classes.length){a.category_classes=a.category_classes.join(" ")}if(O.isArray(a.categories)){var t=O.map(a.categories,function(e){return'<a href="'+F+"all/categories/"+encodeURIComponent(e)+'">'+e+"</a>"});a.category_links=t.join(", ")}if(L.isArray(a.tag_classes)&&a.tag_classes.length){a.tag_classes=a.tag_classes.join(" ")}if(O.isArray(a.tags)){var i=O.map(a.tags,function(e){return'<a href="'+F+"all/tags/"+encodeURIComponent(e)+'">'+e+"</a>"});a.tag_links=i.join(", ")}a.title_link=this.getEventTitleLink(a);a.date_title=this.getWeekDayAndDateFormatFromTimestamp(a.ts_start,a.tz_offset);var n=new A(a.ts_start,a.tz_offset);a.date_start=n.getShortDateString();a.date_start_day=n.getFormattedDate("d");a.date_start_month=n.getFormattedDate("F");a.date_start_month_short=n.getFormattedDate("M");a.date_start_year=n.getFormattedDate("Y");a.date_start_day_of_week=n.getFormattedDate("l");a.time=this.getEventTimeRange(a);a.time_start=n.getTimeString();if(a.ts_end&&a.tz2_offset){var s=new A(a.ts_end,a.tz2_offset);a.date_end=s.getShortDateString();a.date_end_day=s.getFormattedDate("d");a.date_end_month=s.getFormattedDate("F");a.date_end_month_short=s.getFormattedDate("M");a.date_end_year=s.getFormattedDate("Y");a.date_end_day_of_week=s.getFormattedDate("l");a.time_end=s.getTimeString()}var r=a.is_all_day?"F j":"F j, g:ia";if(a.repeats_start){var l=new A(a.repeats_start,a.tz_offset);a.repeats_start=l.getFormattedDate(r)}else{a.repeats_start=""}if(a.repeats_end){var o=new A(a.repeats_end,a.tz_offset);a.repeats_end=o.getFormattedDate(r)}else{a.repeats_end=""}if(a.image_src){a.thumb_width=I.thumb_width;a.thumb_height=I.thumb_height;a.image_orientation="";if(a.image_width&&a.image_height){a.image_orientation=a.image_width>a.image_height?"horizontal":"vertical"}if(E.remote_host&&-1===a.image_src.indexOf(E.remote_host)){a.image_src=E.remote_host+a.image_src}}if(E.is_remote){a.ical_download_href=E.remote_host}else{a.ical_download_href="//"+window.location.hostname}a.ical_download_href+=E.liveurl_dir+"/ical/events/id/"+a.id;a.add_to_google=this.getAddToGoogleLink(a);a.add_to_yahoo=this.getAddToYahooLink(a);if(a.image_raw&&E.remote_host){var c=a.image_raw;var h=c.match(/\ssrc="([^"]*)"/);if(h&&h.length===2&&h[1].charAt(0)==="/"&&(h[1].length===1||h[1].charAt(1)!=="/")){c=c.replace(/\ssrc="([^"]*)"/,' src="'+E.remote_host+h[1]+'"')}c=this.addHostToSrcSetFilter(c,E.remote_host);a.image_raw=c}if(a.location&&a.location.length>I.location_char_limit){a.location=a.location.substr(0,I.location_char_limit)+"..."}O.extend(a,z);return a},getWeekDayAndDateFormat:function(e){var t=this.getDateFromYmd(e);return this.day_names[t.getDay()]+", "+this.month_names[t.getMonth()]+" "+t.getDate()+"<span>, "+t.getFullYear()+"</span>"},getWeekDayAndDateFormatFromTimestamp:function(e,t){var a=this.getDateFromTimestamp(e,t);return this.day_names[a.getUTCDay()]+", "+this.month_names[a.getUTCMonth()]+" "+a.getUTCDate()+"<span>, "+a.getUTCFullYear()+"</span>"},getICalDate:function(e,t){var a,i;if(!e)return"";a=new A(e,0);return a.getFormattedDate("Ymd")+"T"+a.getFormattedDate("His")+"Z"},getAddToGoogleLink:function(e){var t="http://www.google.com/calendar/event?action=TEMPLATE&",a=[],i=this.getICalDate(e.ts_start),n,s;if(e.ts_end){n=e.ts_end}else{n=e.is_all_day?e.ts_start+3600*24:e.ts_start+3600}s=this.getICalDate(n);a.push("text="+encodeURIComponent(e.title));a.push("dates="+i+"/"+s);if(e.summary){a.push("details="+encodeURIComponent(E.lib.htmlDecode(e.summary)))}if(e.location){a.push("location="+encodeURIComponent(e.location))}return t+a.join("&")+"&trp=false&sprop=&sprop=name:"},getAddToYahooLink:function(e){var t="http://calendar.yahoo.com/?v=60&view=d&type=20&",a=[];a.push("title="+encodeURIComponent(e.title));a.push("st="+this.getICalDate(e.ts_start));if(e.ts_end){a.push("et="+this.getICalDate(e.ts_end))}if(e.summary){a.push("desc="+encodeURIComponent(E.lib.htmlDecode(e.summary)))}if(e.location){a.push("in_loc="+encodeURIComponent(e.location))}return t+a.join("&")},getVariablesInTemplate:function(e){var t=e.match(/{{\s*[\w\._-]+\s*}}/g);return t?t.map(function(e){return e.match(/[\w\._-]+/)[0]}):[]},getTemplateVariables:function(e){var t=[];if("day"===e){t=this.getVariablesInTemplate(L("#lw_cal_day_template",W).html()||"")}else if("week"===e){t=this.getVariablesInTemplate(L("#lw_cal_week_template",W).html()||"")}else if("all"===e){t=this.getVariablesInTemplate(L("#lw_cal_all_template",W).html()||"")}else if("month"===e){t=this.getVariablesInTemplate(L("#lw_cal_month_template",W).html()||"")}return t},buildEventList:function(e){var n=this,s="";if(!e||!L.isPlainObject(e)||L.isEmptyObject(e)){return s}if(!this.list_tmpl){this.list_tmpl=O.template(L("#lw_cal_list_template",W).html())}O.each(e,function(e,t){var a="",i=n.getDateFromYmd(t);O.each(e,function(e){a+=n.event_template(n.formatEventObject(e))});s+=n.list_tmpl(O.extend({date:n.getFormattedListDate(i),date_raw:i,year:i.getFullYear(),events:a},z))});return s},getStaticMapImageSrc:function(e,t){map_url=livewhale.liveurl_dir+"/places/thumb?url="+encodeURIComponent("http://maps.googleapis.com/maps/api/staticmap?sensor=false&size=320x320"+"&zoom=17&markers=size:small|"+e+","+t);if(livewhale.remote_host){map_url=livewhale.remote_host+map_url}return map_url}});var s=function(){this.feature_tmpl=O.template(L("#lw_cal_feature",W).html());this.feature_top_tmpl=O.template(L("#lw_cal_feature_top",W).html());this.feature_item_tmpl=O.template(L("#lw_cal_feature_item",W).html());H.on("click",".lw_cal_feature_top,.lw_cal_feature_item",function(e){e.preventDefault();if(L(e.target).hasClass("tz_editable"))return true;var t=L(this).find("a").attr("href");d.loadEventDetailHref(t);return true})};s.prototype=L.extend(n,{build:function(e){var t=this,a="",i="",n=d.getView(),s=0,r,l;if(!e||(!e.top||L.isEmptyObject(e.top))&&(!e.other||!e.other.length)){return""}if(e.top){e.top=this.formatEventObject(e.top);e.top.date_time=n==="week"?this.getMonthAndDayFromTimestamp(e.top.ts_start,e.top.tz_offset)+" ":"";e.top.date_time+=e.top.is_all_day?"All Day":t.getFormattedDateTime(e.top);a=t.feature_top_tmpl(e.top)}if(e.other&&e.other.length){s=e.other.length;for(var o=0;o<s;o++){r=e.other[o];r=this.formatEventObject(r);r.date_time=n==="week"?this.getMonthAndDayFromTimestamp(r.ts_start,r.tz_offset,true)+" ":"";r.date_time+=r.is_all_day?"All Day":t.getFormattedDateTime(r);if(0===o)r.is_first=true;i+=t.feature_item_tmpl(r)}}return this.feature_tmpl({feature_top:a,feature_items:i,sub_feature_count:s})},getFormattedDateTime:function(e){var t=n.getDateFromTimestamp(e.ts_start,e.tz_offset);return n.month_names_short[t.getMonth()]+" "+t.getDate()+" "+n.getEventTimeRange(e)}});var p=new s;var r=E.lwCalendar.FeedBuilderView=function(e){this._cal=e;this.name="feed_builder_view";this.tag_mode="any";this.category_mode="any";var s=this,t=L("#lw_cal_feed_template",W),a=L("#lw_cal_feed_selector_template",W);this.preview_template=O.template(L("#lw_cal_preview_template",W).html());if(!t.length||!a.length)return;this.tmpl=O.template(t.html());this.selector_tmpl=O.template(a.html());this.selected={};this.$events.on("change",".lw_cal_feed_selectors input[type=checkbox]",function(e){var t=L(this),a=t.closest(".lw_cal_feed_selector"),i=a.attr("class").replace(/.*lw_cal_feed_selector_type_([\w_-]+).*/,"$1"),n=t.val();if(typeof s.selected[i]==="undefined"||!O.isArray(s.selected[i])){s.selected[i]=[]}if(t.is(":checked")){s.selected[i].push(n)}else{s.selected[i]=O.without(s.selected[i],n)}s.buildFeed();s.updatePreview()});this.$events.on("keyup",".lw_cal_feed_selectors input[type=text]",function(e){var t=L(this),i=L(this).val().toLowerCase(),a=t.closest(".lw_cal_feed_selector"),n=a.find("ul").children();if(i){n.each(function(){var e=L(this),t=e.find("input"),a=e.text().toLowerCase();if(true===t.prop("checked")||-1!==a.indexOf(i)){e.show()}else{e.hide()}})}else{n.show()}});this.$events.on("click",".lw_filter_mode_toggle a",function(e){e.preventDefault();var t=L(this),a,i,n;if(t.hasClass("selected"))return true;i=t.closest(".lw_filter_mode_toggle");n=i.attr("class").replace(/.*lw_filter_mode_type_(\w+).*/,"$1");a=t.hasClass("lw_any")?"any":"all";if(n==="tag"){s.tag_mode=a}else if(n==="category"){s.category_mode=a}t.addClass("selected").siblings("a").removeClass("selected");s.buildFeed();s.updatePreview();return true})};O.extend(r.prototype,n,{render:function(){var a=this,e=I.feed_builder_filters,i={};if(!O.isArray(e)){return false}if(!this.tmpl||!this.selector_tmpl)return;this.setViewClass("feed_builder");this._cal.getHeader().setTitle("Feed Builder");O.each(e,function(e){var t=a.getSelectorItemByType(e);if(t.length){i[e]=a.selector_tmpl({type:e,items:t})}});this.$events.html(this.tmpl({selectors:i}));this.show();if(!O.isEmpty(this.selected)){this.selected={}}this.$ical_result=this.$events.find("#lw_cal_feed_ical_result");this.$rss_result=this.$events.find("#lw_cal_feed_rss_result");this.$json_result=this.$events.find("#lw_cal_feed_json_result");this.$cms_result=this.$events.find("#lw_cal_feed_cms_result");this.$preview=this.$events.find(".lw_cal_feed_preview");if(w.feed_builder_vars&&!O.isEmpty(w.feed_builder_vars)){this.setFeedToCalendarState()}this.buildFeed();this.updatePreview()},setFeedToCalendarState:function(){var a=this,e=w.feed_builder_vars||{};var t={category:e.categories||[],audience:e.audience||[],campus:e.campus||[],group:e.groups||[],tag:e.tags||[]};O.each(t,function(e,t){O.each(e,function(e){a.$events.find(".lw_cal_feed_selector_type_"+t+' input[type="checkbox"][value="'+e+'"]').each(function(){L(this).trigger("click")})})})},close:function(){w.feed_builder_vars={}},updatePreview:function(){var a=this,e=this.getLink("json",this.selected)+"/max/10",i;var t=L('<div class="lw_spinner"></div>').appendTo(this.$preview);L.getJSON(e,function(e){t.remove();if(e&&e.length){i="<ul>";L.each(e,function(e,t){i+=a.preview_template(a.formatEventObject(t))});i+="</ul>"}else{i="<p>The selected feed does not contain any events.</p>"}a.$preview.html(i)})},getSelectorItemByType:function(e){var t=[];switch(e){case"category":if(O.isArray(E.calendar.categories)){t=O.map(E.calendar.categories,function(e){return{id:e,title:e}})}break;case"audience":if(O.isArray(E.calendar.categories_audience)){t=O.map(E.calendar.categories_audience,function(e){return{id:e,title:e}})}break;case"campus":if(O.isArray(E.calendar.categories_campus)){t=O.map(E.calendar.categories_campus,function(e){return{id:e,title:e}})}break;case"tag":if(O.isArray(E.calendar.tags)){t=O.map(E.calendar.tags,function(e){return{id:e,title:e}})}break;case"group":if(O.isArray(E.calendar.groups)){t=O.map(E.calendar.groups,function(e){return{id:e.fullname,title:e.fullname}})}break}return t},buildFeed:function(){var e=I.feed_base_path?I.feed_base_path:false;this.$ical_result.val(this.getLink("ical",this.selected,e));this.$rss_result.val(this.getLink("rss",this.selected));this.$json_result.val(this.getLink("json",this.selected,e));this.$cms_result.val(this.getLink("cms",this.selected,e))},getLink:function(e,t,a){e=e==="cms"?"json":e;var i=this,n=E.liveurl_dir+"/"+e+"/events";O.each(t,function(e,t){if(t==="category"&&i.category_mode==="any"){n+="/category_mode/any"}if(t==="tag"&&i.tag_mode==="any"){n+="/tag_mode/any"}O.each(e,function(e){n+="/"+t+"/"+encodeURIComponent(e).replace(/'/g,"%27")})});if(a){n=n.replace(E.liveurl_dir+"/"+e+"/events","");n=a+"/"+e+n}else{if(E.is_remote){n=E.remote_host+n;if(n.match(/^\/\//)){n=window.location.protocol+n}}else{n=window.location.protocol+"//"+window.location.host+n}if(e==="ical"&&I.webcal_feed_links){n="webcal://"+n.replace(/^https?:\/\//,"")}}return n}});var l=E.lwCalendar.DayView=function(e){this._cal=e;this.name="day_view";this.template=O.template(L("#lw_cal_day_template",W).html());var t='<div class="no"><p>No events found.</p></div>';this.no_results_tmpl=O.template(L("#lw_cal_no_results_template",W).html()||t);this.is_today=false};O.extend(l.prototype,n,{render:function(e,t,a){var n=this,i=this.getDateFromYmd(a.date),s="",r="",l="",o="",c,h;this.is_today=a.is_today;this.setViewClass(this.is_today?"today":"day");this._cal.getHeader().setTitle(a.title);this._cal.getHeader().insertScrollLinks(a.prev_date,a.next_date);this.insertDateSelector(a.date);if(L.isArray(a.events)&&a.events.length){for(h=0;h<a.events.length;h++){s+=this.event_template(this.formatEventObject(a.events[h]))}}else{s=this.no_results_tmpl({view:t})}if(L.isArray(a.single_events)&&a.single_events.length){for(h=0;h<a.single_events.length;h++){r+=this.event_template(this.formatEventObject(a.single_events[h]))}}if(L.isArray(a.repeating_events)&&a.repeating_events.length){for(h=0;h<a.repeating_events.length;h++){l+=this.event_template(this.formatEventObject(a.repeating_events[h]))}}O.each(a.upcoming_events,function(e,t){var a=n.getDateFromYmd(t);o+="<h4>"+n.getFormattedListDate(a)+"</h4>";for(var i=0;i<e.length;i++){o+=n.event_template(n.formatEventObject(e[i]))}});var _=this.getDateFromYmd(a.date);if(a.weather.description){var d=L.trim(a.weather.description);var u=d.indexOf(" ");if(-1!==u){a.weather.description=d.substr(u+1)+", "+d.substring(0,u)}}if(a.weather.location){var f=L.trim(a.weather.location);var g=f.indexOf(",");if(-1!==g){a.weather.location=f.substring(0,g)}}this.$events.html(this.template({feature:p.build(a.features),month:this.month_names_short[_.getMonth()],date:n.getFormattedListDate(_),day:_.getDate(),today_facts:a.today_facts&&typeof a.today_facts==="string"?a.today_facts:"",weather:a.weather.description!==undefined&&a.weather.location!==undefined?a.weather:"",events:s,single_events:r,repeating_events:l,event_count:a.events.length,upcoming_events:o}));this.show()},insertDateSelector:function(e){var t=this.getDateFromYmd(e),a=[],i="",n,s,r;var l={label:"",value:"",selected:false};for(var o=-4;o<5;o++){n=new Date(t.getTime());n.setDate(n.getDate()+o);s=this.getMdYFromDate(n);r=this.getYmdFromDate(n);if(o===0){a.push(O.extend({},l,{label:"Jump to Day",selected:true}));i+='<option selected="selected">Jump to Day</option>'}else{a.push(O.extend({},l,{label:s,value:r}));i+='<option value="'+r+'">'+s+"</option>"}}this._cal.getHeader().insertDateSelector(this.date_sel_template({dates:a,options:i}))}});var o=E.lwCalendar.HomeView=function(e){this._cal=e;this.name="home_view";this.is_today=false;var t=L("#lw_cal_home_template",W);if(t.length){this.template=O.template(t.html())}else{this.template=O.template(L("#lw_cal_day_template",W).html())}var a=L("#lw_cal_home_event_template",W);if(a.length){this.home_event_template=O.template(a.html())}var i='<div class="no"><p>No events found.</p></div>';this.no_results_tmpl=O.template(L("#lw_cal_no_results_template",W).html()||i)};o.prototype.insertDateSelector=l.prototype.insertDateSelector;O.extend(o.prototype,n,{render:function(e,t,a){var n=this,i=this.getDateFromYmd(a.date),s="",r=[],l="",o=this.home_event_template||this.event_template,c;this.is_today=a.is_today;this.setViewClass(t);this._cal.getHeader().setTitle(a.title);this._cal.getHeader().insertScrollLinks(a.prev_date,a.next_date);this.insertDateSelector(a.date);if(L.isPlainObject(a.events)){O.each(a.events,function(e,t){if(L.isArray(e)){r=r.concat(e)}})}else{r=a.events}if(r.length){for(var h=0;h<r.length;h++){s+=o(this.formatEventObject(r[h]))}}else{s=this.no_results_tmpl({view:t})}O.each(a.upcoming_events,function(e,t){var a=n.getDateFromYmd(t);l+="<h4>"+n.getFormattedListDate(a)+"</h4>";for(var i=0;i<e.length;i++){l+=o(n.formatEventObject(e[i]))}});var _=this.getDateFromYmd(a.date);this.$events.html(this.template({month:this.month_names_short[_.getMonth()],day:_.getDate(),today_facts:"",weather:"",events:s,upcoming_events:l}));this.show()}});var c=E.lwCalendar.ListView=function(e){var a=this,t,i;this._cal=e;this.name="list_view";this.all_tmpl=O.template(L("#lw_cal_all_template",W).html()||"{{ events }}");this.week_tmpl=O.template(L("#lw_cal_week_template",W).html()||"{{ events }}");t='Showing {{ range }} events | <a href="#" class="lw_cal_next">Show {{ more }} more</a>';this.page_tmpl=O.template(L("#lw_cal_pagination_template",W).html()||t);i='<div class="no"><p>No events found.</p></div>';this.no_results_tmpl=O.template(L("#lw_cal_no_results_template",W).html()||i);this.$body.on("click",".lw_cal_pagination > a",function(e){e.preventDefault();var t=L(this).hasClass("lw_cal_all")?true:false;a.showMore(t);return true})};O.extend(c.prototype,n,{render:function(e,t,a){var i=this,n=this._cal,s="",r=a.title,l;if(a.date&&a.end_date){r=this.getDateRange(this.getDateFromYmd(a.start_date),this.getDateFromYmd(a.end_date))}this.setViewClass(t);this._cal.getHeader().setTitle(r);if("week"===t){n.getHeader().insertScrollLinks(a.prev_date,a.next_date);this.insertDateSelector(a.start_date)}else{n.getHeader().clearScrollLinks();n.getHeader().clearDateSelector()}var o="week"===t?this.week_tmpl:this.all_tmpl;if(a.events&&!L.isEmptyObject(a.events)||a.single_events&&!L.isEmptyObject(a.single_events)||a.repeating_events&&!L.isEmptyObject(a.repeating_events)){l={events:this.buildEventList(a.events),repeating_events:this.buildEventList(a.repeating_events),single_events:this.buildEventList(a.single_events)}}else{l={events:this.no_results_tmpl({view:t})}}if(a.event_count>a.per_page){this.page=1;this.per_page=a.per_page;this.count=a.event_count;this.events=a.events;this.$pagination=L("<p/>").addClass("lw_cal_pagination pagination-controls");this.$body.append(this.$pagination);this.showPaginationMenu()}this.$events.html(o(l));this.show()},showPaginationMenu:function(e){var t=Math.ceil(this.count/this.per_page),a="",i;if(e||this.page===t){this.$pagination.hide();return}i=this.per_page;if(this.page===t-1&&this.count%this.per_page!==0){i=this.count%this.per_page}a=this.page_tmpl({range:this.page*this.per_page+" of "+this.count,page:String(this.page+1),more:String(i)});if(this.count<400&&this.count-this.page*this.per_page>this.per_page){a+=' <a href="#" class="list-button caret-button lw_cal_all">Show All</a>'}this.$pagination.html(a)},showMore:function(t){var a=this,e;this.$events.css({opacity:.5});this.page++;e=d.getAjaxUrl()+"&page="+this.page;if(t)e+="&show_all=1";L.ajax({url:e,dataType:"json",success:function(e){if(t){a.events=e.events}else{O.each(e.events,function(e,t){if(a.events[t]){a.events[t]=a.events[t].concat(e)}else{a.events[t]=e}})}a.$events.html(a.buildEventList(a.events));a.showPaginationMenu(t);Y.trigger("calPaginate.lwcal",[d,e]);a.$events.fadeTo(200,1)}})},close:function(e){if(this.$pagination&&this.$pagination.length){delete this.events;this.$pagination.remove();delete this.$pagination}},insertDateSelector:function(e){var a=this,t=[],i="",n=this.getDateFromYmd(e),s,r,l,o;var c=function(e,t){if(e.getMonth()===t.getMonth()){return a.month_names[e.getMonth()]+" "+e.getDate()+"-"+t.getDate()+", "+e.getFullYear()}else{if(e.getFullYear()===t.getFullYear()){return a.month_names[e.getMonth()]+" "+e.getDate()+" - "+a.month_names[t.getMonth()]+" "+t.getDate()+", "+e.getFullYear()}else{return a.month_names[e.getMonth()]+" "+e.getDate()+", "+e.getFullYear()+" - "+a.month_names[t.getMonth()]+" "+t.getDate()+", "+t.getFullYear()}}};var h={label:"",value:"",selected:false};for(var _=-4;_<=4;_++){if(_===0){t.push(O.extend({},h,{label:"Jump to Week",selected:true}));i+='<option selected="selected">Jump to Week</option>'}else{s=new Date(n.getFullYear(),n.getMonth(),n.getDate()+7*_);r=new Date(s.getFullYear(),s.getMonth(),s.getDate()+6);l=c(s,r);o=this.getYmdFromDate(s);t.push(O.extend({},h,{label:l,value:o}));i+='<option value="'+o+'">'+l+"</option>"}}this._cal.getHeader().insertDateSelector(this.date_sel_template({dates:t,options:i}))}});var h=E.lwCalendar.MonthView=function(e){this._cal=e;this.name="month_view";this.template=O.template(L("#lw_cal_month_template",W).html());this.day_template=O.template(L("#lw_cal_month_day_template",W).html());var t=L("#lw_cal_month_event_template",W);if(t.length){this.event_template=O.template(t.html())}};O.extend(h.prototype,n,{render:function(e,t,a){var s=this,r="<tr>",i=this.day_names.slice(0),n;this.setViewClass(t);this._cal.getHeader().setTitle(a.title);this._cal.getHeader().insertScrollLinks(a.prev_date,a.next_date);this.insertDateSelector(a.date);var l=a.days.length;if(I.week_start_offset>0){for(var o=0;o<I.week_start_offset;o++){n=i.shift();i.push(n)}}O.each(a.days,function(e,t){var a="";if(t!==0&&t+1!==l&&t%7===0){r+="</tr><tr>"}for(var i=0;i<e.events.length;i++){var n=e.events[i];if(!O.has(n,"location"))n.location="";n.title_link=s.getEventTitleLink(n);n.time=s.getEventTimeRange(n,true,true);if(L.isArray(n.category_classes)&&n.category_classes.length){n.category_classes=n.category_classes.join(" ")}if(L.isArray(n.tag_classes)&&n.tag_classes.length){n.tag_classes=n.tag_classes.join(" ")}a+=s.event_template(n)}e.events=a;r+=s.day_template(e)});r+="</tr>";this.$events.html(s.template({week_days:"<th>"+i.join("</th><th>")+"</th>",days:r,events:this.buildEventList(a.events),repeating_events:this.buildEventList(a.repeating_events),single_events:this.buildEventList(a.single_events)}));if(O.includes(I.exclude_view,"day")){this.$events.off("click",".lw_cal_date a");this.$events.on("click",".lw_cal_date a",function(){return false})}else{this.hideExcessEvents(a)}this.show()},insertDateSelector:function(e){var t=this.getDateFromYmd(e.substring(0,6)+"01"),a=[],i="",n,s;var r={label:"",value:"",selected:false};for(var l=-6;l<=6;l++){var o=new Date(t.getTime());o.setMonth(o.getMonth()+l);s=this.month_names[o.getMonth()]+" "+o.getFullYear();n=this.getYmdFromDate(o);if(l===0){a.push(O.extend({},r,{label:"Jump to Month",selected:true}));i+='<option selected="selected">Jump to Month</option>'}else{a.push(O.extend({},r,{label:s,value:n}));i+='<option value="'+n+'">'+s+"</option>"}}this._cal.getHeader().insertDateSelector(this.date_sel_template({dates:a,options:i}))},hideExcessEvents:function(l){var e=this,o=I.month_view_day_limit||2;this.$events.find("td").each(function(e,t){var a=L(t),i=a.find(".lw_cal_event"),n=a.find(".lw_cal_date a").attr("href"),s=typeof l.days[e]!=="undefined"?l.days[e].event_count:0,r;if(o<i.length){i.eq(o-1).nextAll().hide()}r=i.filter(":visible");if(s&&s>r.length){a.append(L("<a />",{text:"and "+(s-r.length)+" more...",href:n,class:"lw_cal_show_day"}))}})}});var m=E.lwCalendar.SeoView=function(e){this._cal=e;this.name="seo_view"};O.extend(m.prototype,n,{render:function(e,t,a){var i=this,n=window.location.pathname;if(S&&E.page){n=E.page?E.page.substring(0,E.page.lastIndexOf("/")+1):"/"}L("head").append('<meta name="robots" content="noindex">');this.setViewClass(t);this._cal.getHeader().setTitle("All Upcoming Events");var s="<ul>";O.each(a,function(e){s+='<li><a href="'+e.href+'">'+e.title+"</a></li>"});s+="</ul>";this.$events.html(s);this.show()},close:function(){L('head meta[content="noindex"]').remove()}});var v=E.lwCalendar.EventView=function(V){var i=this;this._cal=V;this.name="event_view";this.$map=null;this.template=O.template(L("#lw_cal_event_detail_template",W).html());this.$body.on("click",".lw_cal_event_tags a",function(e){e.preventDefault();d.setVar("view","all");d.setVar("tags",L(this).text().toLowerCase());d.load();return false});this.$body.on("click",".lw_cal_event_edit a",function(e){e.preventDefault();var t=d.getVar("event_id")[0],a=encodeURIComponent(i.getEventUrl(t,""));window.location=L(this).attr("href")+"&return_url="+a;return true});this.$events.on("click","#lw_cal_add_to_calendar > a",function(e){e.preventDefault();var t=L(this),a=t.closest("#lw_cal_add_to_calendar").find("ul");e.preventDefault();if(a.is(":visible")){t.removeClass("lw_active")}else{t.addClass("lw_active")}a.slideToggle(200);return true});this.render=function(e,t,a){var i=this;var n=false;var s;if(!a||!a.event||!a.event.title){if(e.history.length>1){e.back()}else{e.clearVars();e.load()}return true}if(a.event.url){if(0===a.event.url.indexOf(E.liveurl_dir+"/events/")){s=a.event.url.match(/\/events\/(\d+)/);if(L.isNumeric(s[1])){e.setVar("event_id",s[1]);e.load(null,true,true)}}else{window.location.href=a.event.url}}var r=a.event;if(!S||!e.is_first_load){this.updateMetaData(r)}r.logged_in=E.logged_in;r.date_range="";if(a.event.ts_start){r.date_range=this.getDateRangeFromTimestamps(r.ts_start,r.ts_end,r.tz_offset,r.tz2_offset)}r.date_title=this.getWeekDayAndDateFormatFromTimestamp(r.ts_start,r.tz_offset);var l=new A(r.ts_start,r.tz_offset);r.date_start=l.getShortDateString();r.date_start_day=l.getFormattedDate("d");r.date_start_month=l.getFormattedDate("F");r.date_start_month_short=l.getFormattedDate("M");r.date_start_year=l.getFormattedDate("Y");r.time=this.getEventTimeRange(r);r.time_start=l.getTimeString();if(r.ts_end&&r.tz2_offset){var o=new A(r.ts_end,r.tz2_offset);r.date_end=o.getShortDateString();r.date_end_day=o.getFormattedDate("d");r.date_end_month=o.getFormattedDate("F");r.date_end_month_short=o.getFormattedDate("M");r.date_end_year=o.getFormattedDate("Y");r.time_end=o.getTimeString()}this.setViewClass(t);V.getHeader().setTitle(r.date_range);V.setDocumentTitle(E.lib.htmlEncode(r.title));V.getHeader().showBackLink();V.getHeader().clearDateSelector();if(E.is_remote){r.ical_download_href=E.remote_host}else{r.ical_download_href="//"+window.location.hostname}r.ical_download_href+=E.liveurl_dir+"/ical/events/id/"+r.id;r.add_to_google=i.getAddToGoogleLink(r);r.add_to_yahoo=i.getAddToYahooLink(r);r.date_time=i.getEventDetailTimeRange(r);r.day_of_week=i.getDayOfWeek(r);var c=this.getSaveAndShareLinks(r.title,r.summary,r.image_src,l);var h=L("#lw_cal_event_share_icons",W);if(h.length){var _=O.template(h.html());r.share_links=_(c)}else{r.share_links=this.getDefaultSaveAndShareLinks(c)}if(!O.isEmpty(r.related_content)){if(E.remote_host){r.related_content=O.map(r.related_content,function(e){if(!e.href.match(/^http/)){e.href=E.remote_host+e.href}return e})}var d=L("#lw_cal_event_related_content",W);if(d.length){var u=O.template(d.html());var f="";O.each(r.related_content,function(e){f+=u(e)});r.related_content=f}else{r.related_content=this.getDefaultRelatedContent(r.related_content)}}if(r.search_categories){r.categories=r.search_categories.split("|");var g=O.map(r.categories,function(e){e=L.trim(e);return'<a class="lw_cal_app_link" href="'+F+"view/all/categories/"+encodeURIComponent(e)+'">'+e+"</a>"});r.search_categories=g.join(", ");r.category_links=g.join(", ")}if(O.isArray(r.tags_calendar)){r.tags=r.tags_calendar;var p=O.map(r.tags,function(e){return'<a class="lw_cal_app_link" href="'+F+"view/all/tags/"+encodeURIComponent(e)+'">'+e+"</a>"});r.tags_calendar=p.join(", ")}if(r.summary&&r.description&&r.summary===r.description){r.summary=""}if(r.description&&E.remote_host){r.description=this.addHostToSrcSetFilter(r.description,E.remote_host);r.description=this.addHostToLinks(r.description,E.remote_host)}r.image="";r.template_images="";if(r.images){r.image=this.getDefaultImageGallery(r.images);var m=L("#lw_cal_event_images_template",W);if(m.length){var v=O.template(m.html());O.each(r.images,function(e){r.template_images+=v(e)})}}this.event_data=r;var w=[];L.each(W.html().match(/{{\s*[\w\d_-]+\s*}}/g),function(e,t){t=L.trim(t.substring(2,t.length-2));w[t]=""});this.$events.html(i.template(O.extend(w,r,z)));if(this.$el.find("#lw_cal_hero").length){this.$el.addClass("lw_cal_has_hero");n=true}this.$events.find(".lw_widget").each(function(e,t){E.lib.initWidget(t)});if(r.location_latitude&&r.location_longitude){var y=this.$events.find(".lw_cal_event_detail_map");var b=y.attr("data-aspect-ratio")?y.attr("data-aspect-ratio"):"1:1";y.lwGoogleMapsEmbed({api_key:E.is_remote?livewhale.calendar.maps_api_key:livewhale.maps_api_key,latitude:r.location_latitude,longitude:r.location_longitude,aspect_ratio:b})}if(r.image&&n&&this.$events.find(".lw_item_images > li").length){this.$events.find(".lw_item_images > li:eq(0)").remove()}var k=this.$events.find(".lw_item_images");if(k.length){if(k.find("> li").length){this.$events.find(".lw_item_images").each(function(){var e=L(this);if(e.closest(".lw_slideshow_enable_preview").length){e.on("click",".lw_slideshow_active",function(e){var t=L(this).find("img").attr("src"),a=t.replace(/.*gid\/(\d+)\/.*/,"$1"),i=t.substring(t.lastIndexOf("/")+1),n=E.liveurl_dir+"/image/gid/"+a+"/width/600/height/500/"+i;E.previewImage(n)})}e.slideshow({controlPlacement:"prepend"})})}else{this.$events.find(".lw_item_images").hide()}}if(r.has_registration){E.payments.init()}this.show();if(typeof gapi!=="object"){this.loadPlusOneJS();var D=setInterval(function(){if(typeof gapi==="object"){gapi.plusone.go(i.$events.get(0));clearInterval(D)}},200)}else{gapi.plusone.go(this.$events.get(0))}if(livewhale.disqus_shortname){window.disqus_shortname=livewhale.disqus_shortname;window.disqus_identifier="lwcal_"+livewhale.disqus_shortname+"_"+r.id;window.disqus_url=window.location.origin+"/live/events/"+r.id;window.disqus_title=r.title+" / "+r.date_range;if(window.DISQUS){window.DISQUS.reset({reload:true})}else{var x=document.createElement("script");x.type="text/javascript";x.async=true;x.src="http://"+livewhale.disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(x)}}var C=L("<div>"+r.description+"</div>");var $=C.find(".lw_widget_metadata");var T=[];if($.length){L.each($.find(".lw_widget_resources_js"),function(){if(L.inArray(L(this).attr("data-href"),T)===-1){Y.append('<script src="'+L(this).attr("data-href")+'"><\/script>');T[T.length]=L(this).attr("data-href")}});L.each($.find(".lw_widget_resources_css"),function(){if(L.inArray(L(this).attr("data-href"),T)===-1){Y.append('<link rel="stylesheet" type="text/css" href="'+L(this).attr("data-href")+'" />');T[T.length]=L(this).attr("data-href")}});$.remove()}};this.loadPlusOneJS=function(){Y.append('<script type="text/javascript" size="small" src="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}<\/script>')};this.close=function(e){if(e.getView()!==I.event_view_name){e.clearVar("event_id")}this.$el.removeClass("lw_cal_has_hero")}};O.extend(v.prototype,n,{updateMetaData:function(e){e=e||{};var t;var a;if(e.ts_start){t=new Date(parseInt(e.ts_start,10)*1e3)}var i=e.summary;if(!i&&e.description){i=e.description.substring(0,128)}var n={title:e.title,type:"event",start_time:t.toISOString(),description:i,url:window.location.href};if(e.ts_end){a=new Date(parseInt(e.ts_end,10)*1e3);n.end_time=a.toISOString()}if(e.images&&e.images.length){var s=e.images[0];n.image=s.src;n["image:width"]=s.width;n["image:height"]=s.height}var r=L("head");r.find('meta[property^="og:"').remove();O.each(n,function(e,t){if(e){e=L("<p>"+e+"</p>").text();r.append('<meta property="og:'+t+'" content="'+e+'">');if(t==="description"){var a=r.find('meta[name="description"]');if(a.length){a.attr("content",e)}else{r.append('<meta name="description" content="'+e+'">')}}}})},getEventData:function(){return this.event_data},getDefaultImageGallery:function(e){var t='<ul class="lw_item_images">';O.each(e,function(e){t+="<li>";t+='<img src="'+e.src+'" alt="'+L("<div/>").append(e.caption).text()+'" ';t+='class="lw_image lw_image'+e.id+'"';if(e.width&&e.height){t+=' width="'+e.width+'" height="'+e.height+'"'}t+="/>";if(e.caption){t+='<div class="lw_events_caption">'+e.caption+"</div>"}if(e.credit){t+='<div class="lw_events_credit">'+e.credit+"</div>"}t+="</li>"});t+="</ul>";return t},getCalendarEmbedShareLink:function(){var e;if(E.is_remote){e=E.remote_host;if(e.match(/^\/\//)){e="http:"+e}}else{e=window.location.protocol+"//"+window.location.hostname}e+=E.liveurl_dir+"/events/calendar-embed/"+d.getVar("event_id")[0];return e},getFacebookShareLink:function(){var e=window.location.href;if(!S||E.is_remote){e=this.getCalendarEmbedShareLink()}return"https://www.facebook.com/sharer.php?u="+encodeURIComponent(e)},getTwitterShareLink:function(e,t){var a=window.location.href;var i=this.month_names_short[t.getMonth()]+" "+t.getDate()+", "+e;return"https://twitter.com/intent/tweet?text="+encodeURIComponent(i)+"&url="+encodeURIComponent(a)},getSaveAndShareLinks:function(e,t,a,i){return{facebook:this.getFacebookShareLink(),twitter:this.getTwitterShareLink(e,i)}},getDefaultSaveAndShareLinks:function(n){var s,r;r={twitter:"lw-icon-twitter-square",facebook:"lw-icon-facebook-square",permalink:"lw-icon-link",email:"lw-icon-envelope-o"};s='<div class="lw_widget_saveandshare"><ul>';L.each(["twitter","facebook","email","permalink"],function(e,t){var a=n[t]||"#",i=r[t]||"";s+='<li class="lw_item_'+(e+1)+" "+t+'">'+'<a href="'+a+'" target="_blank" aria-label="Share via '+t+'">'+'<span class="'+i+' lw-icon-2x"></span>'+'<span class="lw_sr_only">'+t+"</span>"+"</a>"+"</li>"});s+="</ul></div>";return s},getDefaultRelatedContent:function(e){if(!O.isArray(e)||!e.length)return"";var t="<ul>";var a=new RegExp(E.liveurl_dir+"/events/([0-9]+).*");O.each(e,function(e){t+='<li class="lw_related_'+e.type;if(e.doc_type){t+=" "+e.doc_type.toLowerCase()}t+='">';if(e.image_src){t+='<img src="'+e.image_src+'"/>'}t+='<a href="'+e.href+'" target="_blank">'+e.title;if(e.doc_type){t+=" <span>("+e.doc_type+")</span>"}t+="</a>"+"</li>"});t+="</ul>";return t},getEventDetailTimeRange:function(e){var t=e.user_offset&&e.tz_offset!==e.user_offset,a,i,n;a=new A(e.ts_start,e.tz_offset);i=e.ts_end?new A(e.ts_end,e.tz2_offset):null;if(!e.is_all_day&&(i&&(a.getMonth()!==i.getMonth()||a.getDate()!==i.getDate()))){n='<span class="lw_cal_time_range">'+a.getTimeString(e.tz_format)+" to "+i.getTimeString(e.tz_format)+"</span> "+this.getDateRange(a,i);if(!I.disable_timezone&&(!I.hide_local_timezone||t)){n+=' <span class="lw_cal_tz_abbrv">'+e.tz_abbrv+"</span>"}}else{n=this.getEventTimeRange(e)}return n},getDayOfWeek:function(e){var t="",a,i;a=new A(e.ts_start,e.tz_offset);i=e.ts_end?new A(e.ts_end,e.tz2_offset):null;if(!i||a.getMonth()===i.getMonth()&&a.getDate()===i.getDate()){t=this.day_names[a.getDay()]}return t}});var w=E.lwCalendar.calView=O.extend({},n,{init:function(){var r=this,t=L("#lw_cal_sidebar",H),n=true;var e=this.header=new g;if(false!==I.show_view_menu){var a=new f(this)}if(!I.show_sidebar){L("#lw_cal_sidebar").hide()}var i=L("#lw_cal_search");if(i.length){var s=O.template(L("#lw_cal_search_template",W).html());i.replaceWith(s())}var l=L("#lw_cal_subscribe");if(l.length){var o=O.template(L("#lw_cal_subscribe_template",W).html());l.replaceWith(o())}this.showing_template=O.template(L("#lw_cal_showing_template",W).html());this._month_view=null;this._home_view=null;this._day_view=null;this._list_view=null;this._event_view=null;this._seo_view=null;this._feed_view=null;this._view=null;this._prev_view=null;this.$now_showing=L("#lw_cal_showing");var c=L('link[rel="canonical"]');if(!c.length){c=L('<link rel="canonical" href="'+document.location.href+'"/>').appendTo(L("head"))}this.page_title=document.title.indexOf("/")===-1?document.title:document.title.substr(0,document.title.indexOf("/")).trim();Y.on("calBeforeChange.lwcal",function(e,t,a,i){r.$events.addClass("lw_cal_loading");if(r._view&&L.isFunction(r._view.close)){r._view.close(t)}if(I.search_all_events_only&&t.getView()!=="all"){t.clearVar("search");t.clearVar("end_date")}});var h=L('head meta[property="og:image"],head meta[name="og:image"]');this.default_og_image=h.length?h.attr("content"):null;if(!I.show_sidebar)this.$el.addClass("no_sidebar");Y.on("calChange.lwcal",function(e,t,a,i){r._view=r.getViewObjectFromViewName(a);if(n){H.find(".lw_spinner").remove()}if(r._prev_view&&r._prev_view.name!==r._view){Y.trigger("calViewClose.lwcal",[r._prev_view])}r._prev_view=r._view;r._view.render(t,a,i);c.attr("href",window.location.href);if(E.is_remote){r._view.$el.find("img").each(function(){var e=L(this),t=e.attr("src");if(t.charAt(0)==="/"&&(t.length===1||t.charAt(1)!=="/")){e.attr("src",E.remote_host+t)}})}if(E.logged_in){r.$events.find(".lw_cal_event").each(function(){var e=L(this),t=e.find(".lw_events_title"),a=e.attr("data-id"),i=encodeURIComponent(r.getEventUrl(e.attr("data-id"),t.text())),n="/livewhale/?events_edit&id="+a+"&return_url="+i,s='<a href="'+n+'" class = "lw_cal_edit_link"><i class="lw-icon-edit lw-icon-fw"></i><span class="lw_sr_only">Edit this event</span></a>';t.append(s)})}r.renderNowShowing(t);if(a!==I.event_view_name){r.setDocumentTitle()}Y.trigger("calLoad.lwcal",[t,i]);n=false});this.$events.on("click",".lw_cal_event_list a:not(.lw_cal_edit_link,.lw_cal_location_link,.lw_cal_app_link,.external_url)",r.clickEventHandler);this.$events.on("click",".tz_editable",function(e){e.preventDefault();var t=L(this);if(t.hasClass("lwui-widget"))return true;e.stopPropagation();u.open(t)});Y.on("change","#lw_cal_calendar select",function(){var e=L(this).val();if(!e)return;if(E.is_remote){if(e==="Main Calendar"){d.clearVar("groups")}else{d.setVar("groups",e)}d.load()}else{document.location=e}});Y.on("calInit.lwcal",function(){var e=d.getVar("groups"),t=L("#lw_cal_calendar select");if(e.length===1&&t.length){t.val(e[0])}});Y.on("calLoad.lwcal",function(e,t){var a=H.offset().top;var i=L("#lw_page");var n=i.length?i.scrollTop():L(window).scrollTop();if(a-n<0){var s=a>30?a-30:a;if(i.length){i.animate({scrollTop:s},250)}else{L("html, body").animate({scrollTop:s},250)}}if(t.getView()===I.event_view_name){livewhale.frontend.initVideo(r.$events)}return true});if(I.sidebar==="default"){L("#lw_cal_search",t).on("click",function(){t.addClass("lw_cal_sidebar_visible");Y.on("click",function(e){if(!L(e.target).closest("#lw_cal_sidebar").length){t.removeClass("lw_cal_sidebar_visible");L(this).off(e)}return true})})}else if(I.sidebar==="original"){t.addClass("lw_cal_sidebar_hidden");H.addClass("lw_cal_original_sidebar");L("#lw_cal_search",t).on("click",function(){if(H.hasClass("lw_cal_month_view")){t.removeClass("lw_cal_sidebar_hidden");Y.on("click",function(e){if(!L(e.target).closest("#lw_cal_sidebar").length){t.addClass("lw_cal_sidebar_hidden");L(this).off(e)}return true})}})}this.initEventHandlers();this.initEditDialog()},getViewObjectFromViewName:function(e){var t;switch(e){case"home":t=this.getHomeView();break;case"today":case"day":t=this.getDayView();break;case"all":case"week":t=this.getListView();break;case"month":t=this.getMonthView();break;case I.event_view_name:t=this.getEventView();break;case"seo":t=this.getSeoView();break;case"feed_builder":t=this.getFeedBuilderView();break;default:}return t},clickEventHandler:function(e){var t=L(this);var a=t.closest(".lw_cal_event");var i=t.attr("href");var n=t.attr("href");if(_&&n.indexOf(_)===0){n=n.substr(_.length)}n=n.replace(/^(\/?#!?)/,"");var s=n.split("/");if(s&&s[0]!=="view"&&!O.includes(I.valid_views,s[0])){if(!E.lib.hasCurrentDomainAndTld(i)){e.preventDefault();window.open(i)}return true}e.preventDefault();var r;if(S){if(s.length===2){r=s[1]}}else{var l;if(a.length){var o=a.find("a[data-date]");if(o.length){i=o.attr("href");l=o.attr("data-date")}}var c=i.substr(i.lastIndexOf("/")+1).match(/^\d+/);if(c&&c.length===1){r=c[0]}}if(r){d.clearVars();d.setVar("event_id",r);d.setVar("view","event");if(l){d.setVar("date",l)}d.load()}return true},getView:function(){return this._view},getMonthView:function(){if(null===this._month_view){this._month_view=new h(this)}return this._month_view},getHomeView:function(){if(null===this._home_view){this._home_view=new o(this)}return this._home_view},getDayView:function(){if(null===this._day_view){this._day_view=new l(this)}return this._day_view},getListView:function(){if(null===this._list_view){this._list_view=new c(this)}return this._list_view},getSeoView:function(){if(null===this._seo_view){this._seo_view=new m(this)}return this._seo_view},getEventView:function(){if(null===this._event_view){this._event_view=new v(this)}return this._event_view},getFeedBuilderView:function(){if(null===this._feed_view){this._feed_view=new r(this)}return this._feed_view},getDefaultOgImage:function(){return this.default_og_image},getHeader:function(){return this.header},setDocumentTitle:function(e){if(!d.is_first_load){e=e||this.header.getTitle();document.title=this.page_title+(e?" / "+e:"")}},renderNowShowing:function(a){var e=this.showing_template;var t=a.getVar("search").length?a.getVar("search")[0]:"";var i=a.getView()==="all";var n=[];var s=["tags","categories","locations","groups","campus","audience"];O.each(s,function(e){var t=a.getVar(e);if(t.length){n.push({name:e,values:t})}});var r=a.getVar("date");var l,o;if(i&&r.length){l=this.getDateFromYmd(r[0]);var c=a.getVar("end_date");if(c.length){o=this.getDateFromYmd(c[0])}}if(n.length||t||l){this.$now_showing.html(e(L.extend({filters:n,search_str:t,start_date:l,end_date:o},z))).show()}else{this.$now_showing.hide()}return true},initEventHandlers:function(){var t=this;this.feed_builder_vars={};Y.on("click",".lw_build_feed_from_calendar",function(e){e.preventDefault();t.feed_builder_vars=d.vars;window.location.hash="#view/feed_builder";return true});Y.on("click",".lw_cal_app_link",function(e){e.preventDefault();var t=L(this).attr("href");d.setVarsInRelativeUrl(t);d.load();return true});var n=L("#lw_cal_search_form").off("submit").on("submit",function(e){e.preventDefault();var t=L(this).find('input[type="text"]'),a=t.val();if(!a&&d.getVar("search").length){d.clearVar("search")}if(a){d.setVar("search",a)}if(I.search_all_events_only||d.getView()===I.event_view_name){d.setVar("view","all")}if(n.find(".lw_skip_link").length==0){n.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>')}d.load();return false});Y.on("calChange.lwcal",function(e,t){var a=t.getVar("search");var i=a.length?a[0]:"";n.find('input[type="text"]').val(i)});if(I.placeholder){L("#lw_cal_search").attr("placeholder",I.placeholder)}this.$events.on("click",".lw_cal_date a",function(e){e.preventDefault();d.setVarsInRelativeUrl(L(this).attr("href"));d.load();return true});this.$events.on("click",".lw_cal_show_day",function(e){e.preventDefault();d.setVarsInRelativeUrl(L(this).attr("href"));d.load();return true});this.$events.on("click","a.lw_cal_show_all_categories",function(e){e.preventDefault();d.vars.categories=[];d.load();return true});this.$events.on("click","a.lw_cal_show_all_calendars",function(e){e.preventDefault();d.vars.calendars=[];d.load();return true});this.$events.on("click","a.lw_cal_show_all_events",function(e){e.preventDefault();d.setVar("view","all");d.load();return true});this.$events.on("click","a.lw_paginate_more, a.lw_paginate_total",function(e){e.preventDefault();if(L(e.target).hasClass("lw_paginate_total")){d.setVar("more","all")}else{var t=d.getVar("more");d.setVar("more",t.length?parseInt(t[0],10)+1:2)}d.load();return true});this.$events.on("click",".lw_widget_saveandshare .email a",function(e){e.preventDefault();E.lib.openEmailShareForm(E.remote_host);return true});Y.on("click","a.lw_cal_location_link",function(e){e.preventDefault();var t=L(e.currentTarget),a=L(e.target),i=t.attr("data-latitude"),n=t.attr("data-longitude"),s;if(a.hasClass("lwui-widget"))return true;e.stopPropagation();s=L("<div/>").attr("id","lw_cal_location_map");var r="";a.hoverbox({position:"left",autoOpen:true,distance:10,html:s,beforeOpen:function(){Y.trigger("click")},open:function(){s.lwGoogleMapsEmbed({api_key:E.is_remote?livewhale.calendar.maps_api_key:livewhale.maps_api_key,latitude:i,longitude:n,zoom:17});s.after('<div class="lw_map_link"><a href="https://www.google.com/maps/place/'+encodeURIComponent(i+","+n)+'" class="lw_skip_link" target="_blank" >Open map in new window</a></div>');L(".lw_map_link").on("click","a",function(e){window.open(L(this).attr("href"),"_blank");return false})},close:function(){L(this).hoverbox("destroy")}});return true})},initEditDialog:function(){if(!E.logged_in){L(".add_event").hide()}var t;Y.on("click",".add_event",function(){if(!t){t=L('<div style="width:400px;"><h3 style="height:35px;">Add Event</h3><form method="post"><div style="height:35px;"><input type="text" name="title" placeholder="Event title"/></div><div style="height:35px;"><input type="text" class="lw_date" name="date" value="" placeholder="Date"/> at <input type="text" class="lw_time" name="time" value="" placeholder="Time"/></div><div><input type="button" name="save" value="Save"/> or <input type="button" name="cancel" value="Cancel"/></div></form></div>').addClass("add_event_overlay").appendTo("body").overlay({autoOpen:false,closeButton:false,destroyOnClose:false});var e=function(e,t){var a=document.createElement("script");a.type="text/javascript";if(a.readyState){a.onreadystatechange=function(){if(a.readyState==="loaded"||a.readyState==="complete"){a.onreadystatechange=null;t()}}}else{a.onload=function(){t()}}a.src=e;document.getElementsByTagName("head")[0].appendChild(a)};e(E.liveurl_dir+"/resource/js/livewhale/thirdparty/jqueryui/jquery-ui.js",function(){e(E.liveurl_dir+"/resource/js/livewhale/scripts/lwui/jquery.lw-timepicker.js",function(){if(!L.browser.msie||L.browser.version>=7){E.lib.initDatepicker(t.find("input.lw_date"));if(L.fn.timepicker){t.find("input.lw_time").timepicker({show24Hours:"euro"===E.timezone_format?true:false,startTime:"8:00am"})}}})});t.on("click",'input[name="cancel"]',function(){t.removeClass("is_open");t.overlay("close")});t.on("click",'input[name="save"]',function(){L.post(E.liveurl_dir+"/events/submit",L(this).parents("form").find(":input").serialize(),function(e){if(e.error){E.prompt("Save Error",e.error,"failure",{Okay:""})}else{t.removeClass("is_open");t.overlay("close");E.prompt("Save Successful","The event was saved successfully.","success",{Okay:""})}},"json")})}if(!t.hasClass("is_open")){t.addClass("is_open");t.overlay("open")}return false})}});var y=E.lwCalendar.subscriptionMenu={init:function(){var n=this,e,t,a,s;var i=this.group=E.group_title||I.group||"";a=L("#lw_cal_subscription_menu_template",W);if(a.length){t=O.template(L("#lw_cal_subscription_menu_template",W).html())}else{t=this.getDefaultTemplate()}if(t&&L.isFunction(t)){e=t({group:i,all_events_link:this.getLink("ical")})}var r=this.$el=L(e);this.$ul=r.find("ul");Y.on("calChange.lwcal",function(e,t,a,i){n.refresh()});r.on("click","a[class^=lw_cal_sub]:not(.lw_clipboard)",function(e){window.open(L(this).attr("href"),"_blank");return false});r.on("click",".lw_clipboard",function(e){e.preventDefault();var t=L(this).attr("href"),a,i;if(-1===t.indexOf("http")&&-1===t.indexOf("webcal")){t=I.host+t}a=livewhale.lib.copyToClipboard(t);if(a){i=r.find(".lw_link_copied")}else{i=r.find(".lw_link_copy_failed")}i.css("opacity",1).fadeIn(200);setTimeout(function(){i.animate({opacity:.5},200)},1200);if(s){s.hoverbox("position")}return true});var l=L("#lw_cal_subscribe");if(l.length){var o=l.offset().left+l.width()<L("body").width()/2?"right":"left";s=l.find("a").hoverbox({position:o,close:function(){r.find(".lw_link_copied").hide();r.find(".lw_link_copy_failed").hide()},html:r})}},getLink:function(e,t){var a=L(decodeURIComponent(d.getWidgetSyntax())),n=E.liveurl_dir+"/"+e+"/events",i=["group","exclude_group","tag","exclude_tag","exclude_subscription"],s=["groups","language","tags","audience","campus"],r="";var l={groups:"group",tags:"tag",audience:"categories_audience",campus:"categories_campus"};O.each(i,function(t){a.find("#"+t).each(function(){var e=encodeURIComponent(L(this).text()).replace(/'/g,"%27");if(e){n+="/"+t+"/"+e}})});if(t){n+="/category/"+encodeURIComponent(t)}L.each(s,function(e,t){var a=d.getVar(t);var i=l[t]||t;if("tag"===i&&a.length>1){n+="/tag_mode/any"}O.each(a,function(e){n+="/"+i+"/"+encodeURIComponent(e)})});if(livewhale.feed_suffix){n+=livewhale.feed_suffix}if(t){if(this.group){r=this.group+" "}r+=t+" Events"}else{r=(this.group?this.group:"All")+" Events"}n+="/header/"+encodeURIComponent(r);if(E.is_remote){n=E.remote_host+n;if(n.match(/^\/\//)){n="http:"+n}}if(e==="ical"&&I.webcal_feed_links){n=n.replace(/^https?:\/\//,"");n="webcal://"+(!E.is_remote?window.location.host:"")+n}return n},getItem:function(e,t){var a=this.getLink("rss",t),i=this.getLink("ical",t),n;n="<li>"+'<a class="lw_cal_sub_cat" target="new" href="'+a+'" rel="nofollow">'+e+"</a> "+'<a class="lw_cal_sub_rss" target="new" href="'+a+'" rel="nofollow">RSS</a> | '+'<a class="lw_cal_sub_ical" target="new" href="'+i+'" rel="nofollow">ICAL</a> | '+'<a class="lw_cal_sub_ical lw_clipboard" href="'+i+'" rel="nofollow">Copy Link</a>'+"</li>";return n},getCategoryItems:function(){var t=this;var a="";L("#lw_cal_category_selector ul > li > label").each(function(){var e=L.trim(L(this).text());a+=t.getItem(e,e)});return a},refresh:function(){var e=this,t=[],a=this.getItem("All Calendars"),i=d.getVar("groups"),n,s;if(i&&i.length===1){s=i[0]}else{s=E.group_title||I.group||""}if(s!==this.group){this.group=s;if(s){this.$el.find("> p:first-child strong").text(s)}else{n=this.$el.find("> p:first-child");n.find("strong").text(n.attr("data-default")||"Main Calendar")}}a+=this.getCategoryItems();var r=this.$el.find("a.lw_cal_sub");if(r.length){r.attr("href",this.getLink("ical"))}this.$ul.html(a)},getDefaultTemplate:function(e,t){return'<div id="lw_cal_subscription_menu">'+'<p data-default="Main Calendar">'+"Current calendar: <strong>{{ group }}</strong>"+"</p>"+'<p><a class="lw_cal_sub" href="{{ all_events_link }}">Subscribe to all {{ group }} events</a></p>'+'<p class="lw_link_copied" style="display: none; margin: 10px 0;">'+"Event feed link copied.<br/>Paste into any calendar app."+"</p>"+'<p class="lw_link_copy_fail" style="display: none; margin: 10px 0;">Unable to copy link!</p>'+'<h6 class="" style="margin: 10px 0;">Subscribe by event type:</h6>'+"<ul></ul>"+"</div>"}};var b=O.extend({},n,{init:function(){var e;var t=this.$el=L("#lw_mini_cal");if(!t.length)return;this.year=null;this.month=null;this.$week_sel=L("<div/>").addClass("lw_week_select").hide();this.today=this.getYmdFromDate(new Date);this.sel_tr=null;var l=this;t.on("click","h3 a,.lw_right,.lw_left",function(e){e.preventDefault();var t=L(this);if(t.hasClass("lw_left")){l.previous()}else if(t.hasClass("lw_right")){l.next()}return true});this.$in_focus=null;var a=function(){var e=t.find("td.selected").first();if(!e.length){e=t.find("tbody td:first")}return e};t.on("keydown","td",function(e){var t=L(e.target);switch(e.which){case 13:e.preventDefault();l.selectDayInFocus();break;case 37:l.prevDayFocus();break;case 39:l.nextDayFocus();break;case 38:e.preventDefault();l.previousWeekFocus();break;case 40:e.preventDefault();l.nextWeekFocus();break}});t.on("click","td",function(e){e.preventDefault();var t=L(this),a=parseInt(t.text(),10),i=l.month,n=l.year;if(!a)return;if(t.hasClass("lw_prev_month")){if(i===1){i=12;n--}else{i--}}if(t.hasClass("lw_next_month")){if(i===12){i=1;n++}else{i++}}L("body").on("calMiniLoad.lwcal",l.focusCurrentDayLink);d.setVar("view",I.default_minical_view);d.clearVar("search");d.clearVar("search_period");d.setDate(n,i,a);d.load()});t.on("click",".lw_week_select",function(e){if(!l.sel_tr)return false;var t=L(l.sel_tr),i;t.children().each(function(e,t){var a=L(t).text();a=a.replace(/>/g,"");if(a){i=parseInt(a,10);return false}});if(i){d.setVar("view","week");d.clearVar("search");d.clearVar("search_period");d.setDate(l.year,l.month,i);d.load()}});t.on("mouseenter","tbody tr",function(e){l.sel_tr=this;var t=L(this).position().top+2;if(L.browser.msie&&parseInt(L.browser.version,10)===8){t+=15}l.$week_sel.show().css("top",t)});t.on("mouseleave","tbody,.lw_week_select",function(e){var t=L(e.toElement||e.relatedTarget);if(t.hasClass("lw_week_select"))return false;l.$week_sel.hide()});t.on("click","table a",function(e){e.preventDefault();return true});Y.on("calChange.lwcal",function(e,t,a,i){var n,s,r;l.data=i;l.view=a;l.render(null,null,null,a)});this.template=O.template(L("#lw_cal_mini_cal_template",W).html())},selectDayInFocus:function(){this.$in_focus.trigger("click")},removeFocus:function(e){e.attr("aria-selected",false).attr("tabindex",-1).removeClass("lw_focus")},addFocus:function(e){e.attr("aria-selected",true).attr("tabindex",0).addClass("lw_focus").trigger("focus")},prevDayFocus:function(){var e=this.$in_focus;this.removeFocus(e);if(0===e.index()){var t=e.closest("tr");this.$in_focus=0===t.index()?t.siblings(":last").find("td:last"):t.prev().find("td:last")}else{this.$in_focus=e.prev()}this.addFocus(this.$in_focus)},nextDayFocus:function(){var e=this.$in_focus;this.removeFocus(e);if(6===e.index()){var t=e.closest("tr");this.$in_focus=t.closest("tbody").find("tr").length===t.index()+1?t.siblings(":first").find("td:first"):t.next().find("td:first")}else{this.$in_focus=e.next()}this.addFocus(this.$in_focus)},previousWeekFocus:function(){var e=this.$in_focus;this.removeFocus(e);var t=e.closest("tr");this.$in_focus=0===t.index()?t.siblings(":last").find("td").eq(e.index()):t.prev().find("td").eq(e.index());this.addFocus(this.$in_focus)},nextWeekFocus:function(){var e=this.$in_focus;this.removeFocus(e);var t=e.closest("tr");this.$in_focus=t.closest("tbody").find("tr").length===t.index()+1?t.siblings(":first").find("td").eq(e.index()):t.next().find("td").eq(e.index());this.addFocus(this.$in_focus)},focusPreviousMonthLink:function(){L("body").off("calMiniLoad.lwcal",this.focusNextMonthLink);L(".lw_left").trigger("focus")},focusNextMonthLink:function(){L("body").off("calMiniLoad.lwcal",this.focusNextMonthLink);L(".lw_right").trigger("focus")},focusCurrentDayLink:function(){L("body").off("calMiniLoad.lwcal",this.focusCurrentDayLink);L("#lw_mini_cal .selected.active").trigger("focus");if(L("#lw_mini_cal + .lw_skip_link").length==0){L("#lw_mini_cal").after('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>')}},previous:function(){var e,t;if(1===this.month){t=12;e=this.year-1}else{t=this.month-1;e=this.year}L("body").on("calMiniLoad.lwcal",this.focusPreviousMonthLink);this.showMonth(e,t)},next:function(){var e,t;if(12===this.month){t=1;e=this.year+1}else{t=this.month+1;e=this.year}L("body").on("calMiniLoad.lwcal",this.focusNextMonthLink);this.showMonth(e,t)},showMonth:function(t,a){var i=this;var n=d.getVar("view")[0]||"day";if(I.mini_cal_heat_map){var e=E.liveurl_dir+"/calendar/month_events_per_day?year="+t+"&month="+a+d.getAjaxQueryString();if(E.remote_host){e=E.remote_host+e}L.ajax({url:e,dataType:"json",success:function(e){i.render(t,a,i.day,n,e)}})}else{this.render(t,a,this.day,n)}},getDates:function(){var e,t,a;var i=d.getVar("date").length?this.getDateFromYmd(d.getVar("date")[0]):new Date;switch(this.view){case"day":case I.event_view_name:e=i;t=e;break;case"week":e=i;t=new Date(e.getFullYear(),e.getMonth(),e.getDate());e.setDate(e.getDate()-e.getDay());t.setDate(e.getDate()+6);break;case"all":e=i;if(d.getVar("end_date").length){t=this.getDateFromYmd(d.getVar("end_date")[0])}else{t=new Date;t.setFullYear(5e3)}break;default:e=new Date;t=new Date;break}e.setHours(0,0,0,0);t.setHours(0,0,0,0);return[e,t]},render:function(_,d,e,t,a){var i=this.getDates(),u=i[0],f=i[1],n;if(!_||!d||!e){n=this.getYmdFromDate(u);_=parseInt(n.substr(0,4),10);d=parseInt(n.substr(4,2),10);e=parseInt(n.substr(6,2),10)}var s=d===1?12:d-1,r=d===1?_-1:_,g=this.getDaysInMonth(r,s),p=this.getDaysInMonth(_,d),l=new Date(_,d-1,1),o=l.getDay(),c=Math.ceil((p+o)/7),h=[],m=0-o,v="",w=_.toString()+(d<10?"0"+d:d.toString()),y=this,b=true,k=a?a:this.data.month_day_cnt||null,D,x,C,$;this.year=_;this.month=d;this.day=e;this.sel_tr=null;var T;var V=M.prototype._pad;h=O.map(O.range(c),function(e){var t="",a,i,n;for(var s=0;s<7;s++){m++;D=false;n=w+(m<10?"0"+m:m.toString());i=[];if(I.mini_cal_heat_map&&k&&k[m]>0){i.push("has_items")}T=y.getDateFromYmd(_+V(d,2)+V(m,2));if(T.getTime()>=u.getTime()&&T.getTime()<=f.getTime()){i.push("selected")}if(y.today===n){i.push("today")}var r=_;var l=d-1;if(m<=0){i.push("lw_prev_month");a=g+m;if(0===d){l=11;r--}else{l--}}else if(m>p){i.push("lw_next_month");a=m-p;if(11===d){l=0;r++}else{l++}}else{i.push("active");i.push("d_"+m);a=m}var o=new Date(r,l,a);var c=new M(o);var h=c.format("F j, Y");t+='<td class="'+i.join(" ")+'" title="'+h+'" aria-label="'+h+'" role="gridcell" aria-selected="false" tabindex="-1">'+'<a href="#" tabindex="-1">'+a+"</a>"+"</td>"}return t});this.$el.html(this.template({mini_cal_body:"<tr>"+h.join("</tr><tr>")+"</tr>",mini_cal_header:this.month_names[d-1]+" "+_}));if(L("#mini_cal_header").length){L("#mini_cal_header").attr("aria-label",L("#mini_cal_header").text())}var S=this.$el.find("td.selected").first();if(S.length){this.$in_focus=S}else{var F=this.$el.find("tbody td:first");this.$in_focus=F}this.$in_focus.attr("tabindex","0").attr("aria-selected","true").attr("aria-label",this.$in_focus.attr("aria-label")+". Use arrow keys to find a date, Enter to select a date.");this.$el.append(this.$week_sel);Y.trigger("calMiniLoad.lwcal",[this,_,d,e])},getDaysInMonth:function(e,t){var a=0===e%4&&e%100||0===e%400?1:0;return t===2?28+a:31-(t-1)%7%2},selectDay:function(e){this.day=e;this.$el.find("td.selected").removeClass("selected");this.$el.find(".d_"+e).addClass("selected")},selectWeek:function(e){this.day=e;this.$el.find("td.selected").removeClass("selected");this.$el.find(".d_"+e).parent("tr").children("td").addClass("selected")}});var k={$el:null,$ul:null,init:function(e){var i=this;this.render();this.$el=L("#"+this.wrapper_id);if(!this.$el.length)return false;this.$ul=this.$("ul").on("click",'input[type="checkbox"]',L.proxy(this.select,this));if(L.isFunction(this.selectorInit())){this.selectorInit()}if(this.$ul.children().length){this.$el.removeClass("lw_hidden").show()}else{this.$el.hide()}Y.on("calChange.lwcal",function(e,t,a){i.highlightSelected.apply(i);return true})},$:function(e){return this.$el.find(e)},addItem:function(e){d.appendVar(this.selector_key,e)},removeItem:function(e){d.removeVar(this.selector_key,e)}};var D=E.lwCalendar.tags=O.extend({selector_key:"tags",id_prefix:"lw_cal_tag_",wrapper_id:"lw_cal_tag_selector",visible:false,$ul:null,render:function(){var e,t;if(I.modular&&I.show_tags){e=L("#lw_cal_tag_selector");if(e.length&&E.calendar.tags){t=O.template(L("#lw_cal_tag_selector_template",W).html());e.replaceWith(t({tags:E.calendar.tags}))}}},selectorInit:function(){var a=this;this.$ul=this.$("ul");this.$toggle=this.$("#lw_cal_tag_toggle");this.$toggle.on("click",function(e){e.preventDefault();var t=L(this);a.toggleVisibility();a.visible=true;return false});this.$ul.hide();if(window.location.hash.indexOf("tags/")!==-1){this.toggleVisibility()}},toggleVisibility:function(){if("show"===this.$toggle.text()){this.$toggle.text("hide").attr("aria-expanded",true)}else{this.$toggle.text("show").attr("aria-expanded",false)}this.$ul.slideToggle("medium")},select:function(e){if(!L(e.target).is("input[type=checkbox],label")){return true}var t=L(e.currentTarget).closest("li"),a=L.trim(t.find("label").text());if(t.hasClass("selected")){t.removeClass("selected");this.removeItem(a)}else{t.addClass("selected");this.addItem(a)}L(".lw_cal_tag .lw_skip_link").remove();t.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>');if(d.getView()===I.event_view_name){d.setVar("view","all");d.clearVar("event_id")}Y.trigger("lw.tagUpdated");d.load();return true},highlightSelected:function(){var e=this,n=d.getValue(this.selector_key),s=false;if(n&&n.length){this.$ul.children().each(function(e,t){var a=L(t),i=a.find("input:checkbox");if(L.isArray(n)&&-1!==L.inArray(L.trim(a.find("label").text()),n)){a.addClass("selected").find("input:checkbox").prop("checked",true);s=true}else if(a.hasClass("selected")){a.removeClass("selected").find("input:checkbox").prop("checked",false)}})}else{this.$ul.children("li.selected").removeClass("selected").find("input:checkbox").prop("checked",false)}return true}},k);var x=E.lwCalendar.categories=O.extend({selector_key:"categories",id_prefix:"lw_cal_cat_",wrapper_id:"lw_cal_category_selector",render:function(){var e,t;if(I.modular&&I.show_categories){e=L("#lw_cal_category_selector");if(e.length&&E.calendar.categories){t=O.template(L("#lw_cal_category_selector_template",W).html());e.replaceWith(t({categories:E.calendar.categories}))}}},selectorInit:function(){if(I.exclusive_categories){L("<li/>").addClass("all").text("All").prependTo(this.$ul)}},select:function(e){if(I.exclusive_categories){this.select=this.selectCategory}else{this.select=this.toggleCategory}return this.select(e)},toggleCategory:function(e){var t=L(e.currentTarget).closest("li");if(!L(e.target).is("input[type=checkbox]")){return true}if(t.hasClass("selected")){this.deselectItem(t)}else{this.selectItem(t)}L(".lw_cal_selector .lw_skip_link").remove();t.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>');if(d.getView()===I.event_view_name){d.setVar("view","all");d.clearVar("event_id")}d.load();return true},selectCategory:function(e){var t=this,a=L(e.currentTarget).closest("li"),i=d.getView();if(!L(e.target).is("input[type=checkbox]")){return true}if(a.hasClass("selected"))return true;L(".lw_cal_selector .lw_skip_link").remove();a.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>');d.clearVar("categories");d.clearVar("group");if("all"===i){d.setVar("view","day");d.clearVar("tags");d.clearVar("locations");d.clearVar("search");d.clearVar("search_period")}if(i===I.event_view_name){d.setVar("view","day");d.clearVar("event_id")}if(!a.hasClass("all")){this.selectItem(a)}d.load();return true},selectItem:function(e){var t=e.find("input");var a=t.length&&t.val()?t.val():e.find("label").text();this.addItem(a)},deselectItem:function(e){var t=e.find("input");var a=t.length&&t.val()?t.val():e.find("label").text();this.removeItem(a)},highlightSelected:function(){var i=d.getValue(this.selector_key);if(i&&i.length){this.$ul.children().each(function(e,t){var a=L(t);if(L.isArray(i)&&-1!==L.inArray(L.trim(a.find("label").text()),i)){a.addClass("selected");a.find("input:checkbox").prop("checked",true)}else if(a.hasClass("selected")){a.removeClass("selected");a.find("input:checkbox").prop("checked",false)}})}else{this.$ul.children("li.selected").removeClass("selected").find("input:checkbox").prop("checked",false);if(I.exclusive_categories){this.$ul.children(".all").addClass("selected")}}return true}},k);var C=E.lwCalendar.audience=O.extend({selector_key:"audience",id_prefix:"lw_cal_cat_audience_",wrapper_id:"lw_cal_category_audience_selector",render:function(){var e,t;if(I.modular&&I.show_categories){e=L("#lw_cal_category_audience_selector");if(e.length&&E.calendar.categories){t=O.template(L("#lw_cal_category_audience_selector_template",W).html());e.replaceWith(t({audiences:E.calendar.categories_audience}))}}},selectorInit:function(){if(I.exclusive_categories){L("<li/>").addClass("all").text("All").prependTo(this.$ul)}},select:function(e){var t=L(e.currentTarget).closest("li");if(!L(e.target).is("input[type=checkbox]")){return true}if(t.hasClass("selected")){this.deselectItem(t)}else{this.selectItem(t)}L(".lw_cal_selector .lw_skip_link").remove();t.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>');if(d.getView()===I.event_view_name){d.setVar("view","all");d.clearVar("event_id")}d.load();return true},selectItem:function(e){var t=e.find("input");var a=t.length&&t.val()?t.val():e.find("label").text();this.addItem(a)},deselectItem:function(e){var t=e.find("input");var a=t.length&&t.val()?t.val():e.find("label").text();this.removeItem(a)},highlightSelected:function(){var i=d.getValue(this.selector_key);if(i&&i.length){this.$ul.children().each(function(e,t){var a=L(t);if(L.isArray(i)&&-1!==L.inArray(L.trim(a.find("label").text()),i)){a.addClass("selected");a.find("input:checkbox").prop("checked",true)}else if(a.hasClass("selected")){a.removeClass("selected");a.find("input:checkbox").prop("checked",false)}})}else{this.$ul.children("li.selected").removeClass("selected").find("input:checkbox").prop("checked",false);if(I.exclusive_categories){this.$ul.children(".all").addClass("selected")}}return true}},k);var $=E.lwCalendar.campus=O.extend({selector_key:"campus",id_prefix:"lw_cal_cat_campus_",wrapper_id:"lw_cal_category_campus_selector",render:function(){var e=L("#lw_cal_category_campus_selector");var t;if(e.length&&E.calendar.categories_campus){t=O.template(L("#lw_cal_category_campus_selector_template",W).html());e.replaceWith(t({campuses:E.calendar.categories_campus}))}},selectorInit:function(){if(I.exclusive_categories){L("<li/>").addClass("all").text("All").prependTo(this.$ul)}},select:function(e){var t=L(e.currentTarget).closest("li");if(!L(e.target).is("input[type=checkbox]")){return true}if(t.hasClass("selected")){this.deselectItem(t)}else{this.selectItem(t)}L(".lw_cal_selector .lw_skip_link").remove();t.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>');if(d.getView()===I.event_view_name){d.setVar("view","all");d.clearVar("event_id")}d.load();return true},selectItem:function(e){var t=e.find("input");var a=t.length&&t.val()?t.val():e.find("label").text();this.addItem(a)},deselectItem:function(e){var t=e.find("input");var a=t.length&&t.val()?t.val():e.find("label").text();this.removeItem(a)},highlightSelected:function(){var i=d.getValue(this.selector_key);if(i&&i.length){this.$ul.children().each(function(e,t){var a=L(t);if(L.isArray(i)&&-1!==L.inArray(L.trim(a.find("label").text()),i)){a.addClass("selected");a.find("input:checkbox").prop("checked",true)}else if(a.hasClass("selected")){a.removeClass("selected");a.find("input:checkbox").prop("checked",false)}})}else{this.$ul.children("li.selected").removeClass("selected").find("input:checkbox").prop("checked",false);if(I.exclusive_categories){this.$ul.children(".all").addClass("selected")}}return true}},k);var T=E.lwCalendar.locations=O.extend({selector_key:"locations",id_prefix:"lw_cal_loc_",wrapper_id:"lw_cal_location_selector",render:function(){var e,t;if(I.modular&&I.show_locations){e=L("#"+this.wrapper_id);if(e.length&&E.calendar.locations){t=O.template(L("#"+this.wrapper_id+"_template",W).html());e.replaceWith(t({locations:E.calendar.locations}))}}},selectorInit:function(){this.locations={};if(O.isArray(E.calendar.locations)&&E.calendar.locations.length){this.locations=O.reduce(E.calendar.locations,function(e,t){e[t.id]=t.title;return e},{})}if(I.exclusive_categories){L("<li/>").addClass("all").text("All").prependTo(this.$ul)}},getLocation:function(e){return this.locations[e]},select:function(e){if(!L(e.target).is("input[type=checkbox]")){return true}var t=L(e.currentTarget).closest("li"),a=t.find("input").val();if(t.hasClass("selected")){t.removeClass("selected");this.removeItem(a)}else{t.addClass("selected");this.addItem(a)}L(".lw_cal_selector .lw_skip_link").remove();t.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>');if(d.getView()===I.event_view_name){d.setVar("view","all");d.clearVar("event_id")}d.load();return true},highlightSelected:function(){var n=d.getValue(this.selector_key);if(n&&n.length){this.$ul.children().each(function(e,t){var a=L(t),i=a.find("input").val();if(L.isArray(n)&&-1!==L.inArray(i,n)){a.addClass("selected");a.find("input:checkbox").prop("checked",true)}else if(a.hasClass("selected")){a.removeClass("selected");a.find("input:checkbox").prop("checked",false)}})}else{this.$ul.children("li.selected").removeClass("selected").find("input:checkbox").prop("checked",false)}return true}},k);var V=E.lwCalendar.groups=O.extend({selector_key:"groups",id_prefix:"lw_cal_group_",wrapper_id:"lw_cal_group_selector",render:function(){var e,t;if(I.modular&&I.show_categories){e=L("#lw_cal_group_selector");if(e.length&&E.calendar.groups){t=O.template(L("#lw_cal_group_selector_template",W).html());e.replaceWith(t({groups:E.calendar.groups}))}}},selectorInit:function(){var a=this,e=d.getValue(this.selector_key)||[];this.$lis=this.$ul.children();this.group_cnt=this.$lis.length;this.$el.on("click",".select",function(e){var t=L(this);e.preventDefault();if(t.hasClass("all")){a.$lis.not(".selected").each(function(){a.selectItem(L(this))})}else{a.$lis.filter(".selected").each(function(){a.deselectItem(L(this))})}d.load();return true})},select:function(e){var t=L(e.currentTarget).closest("li"),a=t.text();if(!L(e.target).is("input[type=checkbox]")){return true}if(t.hasClass("selected")){this.deselectItem(t)}else{this.selectItem(t)}L(".lw_cal_selector .lw_skip_link").remove();t.append('<a href="#lw_cal_events" class="lw_skip_link">Skip to results</a>');if(d.getView()===I.event_view_name){d.setVar("view","all");d.clearVar("event_id")}d.load();return true},markAllSelected:function(){this.$ul.children().addClass("selected").find("input:checkbox").prop("checked",true)},markAllDeselected:function(){this.$ul.children().removeClass("selected").find("input:checkbox").prop("checked",false)},selectItem:function(e){if(e.hasClass("selected"))return;e.addClass("selected").find("input").prop("checked",true);var t=this.$lis.filter(".selected").length;if(t!==1&&t===this.group_cnt){d.clearVar("groups")}else{this.addItem(e.find("input").val())}},deselectItem:function(e){var t=this;if(!e.hasClass("selected"))return;e.removeClass("selected").find("input").prop("checked",false);var a=this.$lis.filter(".selected").length;if(a!==0&&a===this.group_cnt-1){this.$lis.filter(".selected").each(function(){t.addItem(L(this).find("input").val())})}else{this.removeItem(e.find("input").val())}},highlightSelected:function(){var i=d.getValue(this.selector_key);this.$ul.children().removeClass("selected").find("input:checkbox").prop("checked",false);if(i&&i.length){this.$ul.children().each(function(e,t){var a=L(t);if(L.isArray(i)&&-1!==L.inArray(L.trim(a.find("input[type=checkbox]").val()),i)){a.addClass("selected");a.find("input:checkbox").prop("checked",true)}})}return true}},k);var U=E.lwCalendar.calendars={init:function(){var e,t;if(I.modular&&I.show_categories){e=L("#lw_cal_calendar_selector");if(e.length&&!O.isEmpty(E.calendar.calendars)){t=O.template(L("#lw_cal_calendar_selector_template",W).html());e.replaceWith(t({calendars:E.calendar.calendars}))}}}};if(L(".lw_msg_failure").length&&window.innerWidth&&window.innerWidth<=480){L(".lw_msg_failure").remove()}function j(){w.init();x.init();C.init();$.init();D.init();V.init();U.init();T.init();y.init();b.init();d.init()}Y.trigger("calBeforeInit.lwcal");j()}function i(e){e=L.isPlainObject(e)?e:{};var a={default_view:"day",default_minical_view:"day",month_view_day_limit:4,week_start_offset:0,exclude_view:[],show_view_menu:true,show_sidebar:true,show_dynamic_group_menu:false,show_static_group_menu:false,show_tags:false,show_categories:true,month_view_only:false,webcal_feed_links:true,search_all_events_only:true,ampm_with_dots:false,use_modular_templates:true,hide_local_timezone:E.disable_timezones?true:false,disable_timezone:E.disable_timezones?true:false,sidebar:"default",feed_builder_filters:["category","audience","campus","group","tag"],placeholder:"",enable_home_view:false,thumb_width:80,thumb_height:80,location_char_limit:50,modular:false,feed_base_path:null,tag_mode:"and",host:l+"//"+window.location.hostname,event_view_name:"event",valid_views:["today","day","week","month","all","home","event","seo","feed_builder"]};if(E.is_remote){E.calendar_widget_args=e.widget_args}var t=L.isPlainObject(E.calendar_widget_args)?E.calendar_widget_args:{};var i=O.extend({},a,e,t);if(i.valid_views!=="event"){i.valid_views.push(i.event_view_name)}var n=["show_view_menu","show_sidebar","month_view_only","show_static_group_menu","show_dynamic_group_menu","show_tags","show_categories","disable_timezone","webcal_feed_links","hide_local_timezone","search_all_events_only","mini_cal_heat_map","enable_home_view","modular","use_modular_templates"];var s=["default_view","sidebar","placeholder","tag_mode"];O.each(s,function(e){var t=i[e];if(L.isArray(t)){if(t.length){i[e]=t[t.length-1]}else{i[e]=typeof a[e]==="string"?a[e]:""}}});var r=function(e){return"false"===e||"False"===e?false:!!e};O.each(n,function(e){if(i[e]&&!O.isBoolean(i[e]))i[e]=r(i[e])});i.month_view_day_limit=parseInt(i.month_view_day_limit,10);if(typeof i.exclude_view==="string")i.exclude_view=[i.exclude_view];if(true===i.month_view_only){i.default_view="month";i.exclude_view=["day","week","all"];i.show_view_menu=i.show_sidebar=false}return i}function s(i){var e=E.remote_host+E.liveurl_dir+"/calendar/remote_calendar?syntax="+P.getWidgetSyntaxFromArgObject(i.widget_args||{});L.ajax({url:e,dataType:"json",success:function(e,t,a){if(a.getResponseHeader("access-control-allow-credentials")==="true"){i.with_credentials=true}if(e.fb_app_id){E.facebook_lwc_app_id=e.fb_app_id}if(e.use_pushstate){E.lwc_use_pushstate=e.use_pushstate}if(e.disable_timezones){i.hide_local_timezone=true;i.disable_timezone=true}if(e.date_format_us){E.date_format_us=e.date_format_us}if(e.date_format_euro){E.date_format_euro=e.date_format_euro}if(e.time_format_us){E.time_format_us=e.time_format_us}if(e.time_format_euro){E.time_format_euro=e.time_format_euro}E.calendar=E.calendar||{};O.extend(E.calendar,e);n(i)}})}function a(e){var t=livewhale.remote_host?livewhale.remote_host:"";t+=livewhale.liveurl_dir+"/component/"+e+"/";var a=O.map(["date_selector","day","home","home_event","calendars","categories","categories_audience","categories_campus","groups","locations","tags","event_detail","event","event_images","event_related_content","event_share_icons","feature","feature_item","feature_top","feed_builder","feed_selector","header","list","all","week","mini_cal","month","month_day","month_event","no_results","scroll_link","search","showing","subscribe","subscription_menu","timezone_menu","view_selector"],function(e){return"calendar%5Clw_cal_"+e+".html"});return t+a.join("/")}function r(e,t){L.ajax({url:a(e),dataType:"html",cache:true,success:function(e){W=L('<div id="lw_cal_js_templates"></div>').append(e).appendTo(H);t.apply()},error:function(){t.apply(null,["error"])}})}function o(e,t){var a=livewhale.remote_host?livewhale.remote_host:"";a+=livewhale.liveurl_dir+"/component/"+e+"/";a+="%5Ccalendar.html/%5Ccalendar-components.html";L.ajax({url:a,dataType:"html",cache:true,success:function(e){W=L('<div id="lw_cal_js_templates"></div>').append(e).appendTo(H);t.apply()},error:function(){t.apply(null,["error"])}})}window.liveWhaleCalendar=function(a){a=i(a||{});var e=a.theme||livewhale.theme||"core";var t=function(t){L(function(){if(t){var e="<h3>Unable to load calendar templates. <strong>Please disable any ad blockers and "+"try again</strong>, or email support@livewhale.com if this problem persists.</h3>";L("#lw_cal_events").append(e)}else{if(E.is_remote){s(a)}else{n(a)}}})};if(a.use_modular_templates){r(e,t)}else{o(e,t)}};if(E.page){window.liveWhaleCalendar()}})(typeof livewhale!=="undefined"&&livewhale.jQuery?livewhale.jQuery:jQuery,window._);